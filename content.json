{"pages":[],"posts":[{"title":"Guide for changing dev environment from Mac to Windows","text":"æœ€è¿‘å› ä¸ºæ²‰è¿·æ¸¸æˆï¼Œé•¿æœŸåœ¨æ¸¸æˆæœ¬ä¸Šå‡ºç”Ÿå…¥æ­»ï¼Œæ‰‹é‡Œé‚£å°ç”¨æ¥èŠå¤©çš„ Mac å°±æ™¾åœ¨è¾¹ä¸Šå¥½ä¹…æ²¡æ€å¼€è¿‡äº†ã€‚æƒ³ç€æ‰‹é‡Œå‡ ä¸ªå°é¡¹ç›®æ¢ç”µè„‘ææ¥æå»ä¹ŸæŒºéº»çƒ¦çš„ï¼Œæ‰€ä»¥å†³å®šåœ¨ windows æœ¬ä¸Šè¿˜åŸä¸€ä¸‹åœ¨ Mac ä¸Šçš„å·¥ä½œç¯å¢ƒã€‚ åœ¨ Mac ä¸Šæˆ–è€…è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬çš„å¼€å‘ã€éƒ¨ç½²ç¯å¢ƒåŸºæœ¬éƒ½æ˜¯ç±» Unix çš„ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æŠŠ WSL2 å®‰è£…ä¸Šï¼Œå¹¶ä¸”ç»™ç³»ç»Ÿå®‰è£…ä¸€ä¸ªä¸å¤ªæ‹‰èƒ¯çš„ç»ˆç«¯ï¼Œä»¥åŠé…ç½® wsl ä¸­ç³»ç»Ÿçš„ä½¿ç”¨ç¯å¢ƒã€‚ é€‰æ‹©åœ¨ wsl ä¸­å¼€å‘ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„åŸå› ï¼Œå°±æ˜¯ windows å’Œ Unix çš„æ¢è¡Œç¬¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯èƒ½ä¼šå¸¦æ¥ä¸€äº›ç¼–ç æ–¹é¢çš„é—®é¢˜ï¼Œæ¯”å¦‚ git å†²çªã€‚ å®‰è£… WSLå¾®è½¯æŠŠ WSL å«åš é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“è¿™æ˜¯ä¸€ä¸ªè·¨æ“ä½œç³»ç»Ÿçš„ linux ç¯å¢ƒå°±å¥½äº†ï¼Œè¯¦ç»†çš„è¯´æ³•è¿˜æ˜¯çœ‹ wsl çš„æ–‡æ¡£ã€‚ä» windows 10 å¼€å§‹ï¼Œç³»ç»Ÿæä¾›äº† WSL é›†æˆï¼Œå‘å±•åˆ°ç°åœ¨çš„ windows ç‰ˆæœ¬ï¼Œå·²ç»æœ‰äº† WSL 2 ï¼Œæ¨èå‡çº§åˆ° WSL 2ï¼Œç°åœ¨èƒ½ä¸ç³»ç»Ÿæ›´å¥½çš„ç»“åˆå·¥ä½œå¹¶ä¸”æä¾›äº†å®Œæ•´çš„ Linux å†…æ ¸ï¼Œdocker desktop ç°åœ¨ä¹Ÿä¸ WSL2 é«˜åº¦é€‚é…ã€‚ å®‰è£… WSL 2 éœ€è¦æ»¡è¶³ windows 10 çš„ç³»ç»Ÿç‰ˆæœ¬è¦æ±‚ï¼ŒX64 ç³»ç»Ÿéœ€è¦ç‰ˆæœ¬ 1903 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œé‡‡ç”¨ å†…éƒ¨ç‰ˆæœ¬ 18362.1049 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ ä¸ºäº†é¿å…ä¸€äº›éº»çƒ¦ï¼Œä»¥ä¸‹å‘½ä»¤å‡åœ¨ç®¡ç†å‘˜èº«ä»½çš„ PowerShell ä¸­è¿è¡Œã€‚ æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦ç¬¦åˆ WSL 2 è¿è¡Œè¦æ±‚å…ˆç¡®å®šä¸€ä¸‹ç³»ç»Ÿç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚ 12# å›è½¦è¿è¡Œåï¼Œä¼šå¼¹å‡ºä¸€ä¸ªçª—å£ï¼Œåªè¦æ˜¾ç¤ºçš„å†…éƒ¨ç‰ˆæœ¬å·å¤§äºä¸Šæ–‡æ‰€è¯´çš„è¦æ±‚å³å¯winver å¦‚æœç³»ç»Ÿç‰ˆæœ¬ä¸ç¬¦åˆè¦æ±‚ï¼Œè¯·å…ˆå‡çº§åˆ°è¾ƒæ–°çš„ç‰ˆæœ¬å†æ‰§è¡Œä»¥ä¸‹çš„æ“ä½œã€‚ å¯ç”¨ WSLå¦‚æœç³»ç»Ÿç¬¦åˆè¦æ±‚ï¼Œè¯·æ¥ç€å¾€ä¸‹ã€‚ 12# è¿™æ¡å‘½ä»¤ä¼šå¼€å¯ç³»ç»Ÿçš„ wsl åŠŸèƒ½ï¼Œå’Œä½ åœ¨æ§åˆ¶é¢æ¿é‡Œæ‰‹åŠ¨å‹¾é€‰æ˜¯ä¸€æ ·çš„dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart å¯ç”¨ è™šæ‹ŸåŒ–åŠŸèƒ½ç”±äº WSL 2 éœ€è¦è™šæ‹ŸåŒ–åŠŸèƒ½æ‰å¯ä»¥è¿è¡Œï¼Œæ‰€ä»¥éœ€è¦å…ˆå¯ç”¨ è™šæ‹Ÿå¹³å° åŠŸèƒ½ã€‚ 12# å¯ç”¨ `è™šæ‹Ÿå¹³å°`dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart è‡³æ­¤ï¼Œå…ˆé‡å¯ç³»ç»Ÿä»¥å®Œæˆ WSL çš„å®‰è£…å¹¶å‡çº§åˆ° WSL 2ã€‚ æ›´æ–° WSL 2 Linux å†…æ ¸é‡å¯å®Œæˆåï¼Œç³»ç»Ÿå°±å·²ç»æŠŠ WSL å®‰è£…å¥½äº†ï¼Œåœ¨åˆ‡æ¢åˆ° WSL 2 ä¹‹å‰ï¼Œå»ºè®®å…ˆæ›´æ–°ç³»ç»Ÿçš„ WSL 2 Linux å†…æ ¸ï¼Œä»¥å… WSL åˆ‡æ¢åˆ° WSL 2 æ—¶æŠ¥é”™ï¼š é€‚ç”¨äº x64 è®¡ç®—æœºçš„ WSL2 Linux å†…æ ¸æ›´æ–°åŒ… å°† WSL 2 è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬ç°åœ¨éœ€è¦æŠŠ WSL 2 è®¾ç½®ä¸ºé»˜è®¤çš„ WSL ç‰ˆæœ¬ï¼š 1wsl --set-default-version 2 å®‰è£…ä½ å–œæ¬¢çš„ Linux å‘è¡Œç‰ˆç°åœ¨ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œå°±å·®ä¸€ä¸ª Linux äº†ã€‚åˆ° Microsoft Store æ‰¾ä¸€ä¸ªå‘è¡Œç‰ˆå®‰è£…ã€‚åœ¨æœç´¢é‡Œè¾“å…¥ WSL å°±ä¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ Linux å‘è¡Œç‰ˆï¼Œæˆ‘å®‰è£…çš„æ˜¯ Ubuntu 20.04 LTSï¼Œæ‰€ä»¥ å®‰è£… WSL è¿™èŠ‚ä¹‹åçš„å†…å®¹ï¼Œä¸ç‰¹æŒ‡çš„è¯éƒ½æ˜¯åœ¨ Ubuntu 20.04 LTS ä¸­æ‰§è¡Œçš„ã€‚ å®‰è£…å¥½åï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œä¼šå¼€å§‹åˆå§‹åŒ–ç³»ç»Ÿï¼Œå¹¶éœ€è¦ä½ ä¸ºè¿™ä¸ª Linux åˆ›å»ºç”¨æˆ·å’Œå¯†ç ï¼Œè¿™ä¸ªå¯†ç å°±æ˜¯ä»¥åä½ åœ¨ wsl ä¸­è¾“å…¥ sudo å‘½ä»¤åï¼Œéœ€è¦è¾“å…¥çš„å¯†ç ã€‚ WSL è¿›é˜¶ç½‘ç»œWSL 2 çš„ç½‘ç»œä¸å’Œ windows ç›´æ¥äº’é€šã€‚åœ¨ windows ä¸­è®¿é—® WSL 2 é‡Œçš„æœåŠ¡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ http://localhost:8000 è¿™ç§æ–¹å¼ï¼Œä½†æ˜¯ WSL 2 é‡Œå°±ä¸èƒ½ç›´æ¥è®¿é—® windows é‡Œçš„ web æœåŠ¡äº†ï¼Œæ–°ç‰ˆæœ¬çš„ WSL 2 è¦æ‹¿ windows çš„ IP æ¯”è¾ƒéº»çƒ¦ï¼Œç›®å‰ç½‘ä¸Šçš„å„ç§æ–¹æ³•ï¼Œå‡ ä¹æ²¡ä½œç”¨ã€‚ æ–‡ä»¶äº’è®¿åœ¨ WSL 2 é‡Œè®¿é—® windows çš„ç›®å½•å’Œæ–‡ä»¶è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚windows çš„åˆ†åŒºä¼šå…¨éƒ¨æŒ‚è½½åˆ° /mnt/ ä¸‹ï¼Œæ¯”å¦‚è¦è®¿é—® D:\\ï¼Œå¯ä»¥ä½¿ç”¨ cd /mnt/dã€‚è€Œåœ¨ windows é‡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨èµ„æºç®¡ç†å™¨çš„åœ°å€æ ä¸­è¾“å…¥ \\\\wsl$ è®¿é—®æ‰€æœ‰å·²ç»å®‰è£…çš„ WSLã€‚ è€Œæ›´åŠ æ–¹ä¾¿çš„æ˜¯ï¼Œå¯ä»¥ç›´æ¥åœ¨ WSL çš„ shell ç¯å¢ƒä¸­ç›´æ¥æ‰§è¡Œ windows ä¸­çš„ç¨‹åºï¼Œç±»ä¼¼äº Mac ä¸‹çš„ openï¼Œä¾‹å¦‚ï¼š 123456# ä½¿ç”¨ vs code æ‰“å¼€æŒ‡å®šçš„ç›®å½•æˆ–è€…æ–‡ä»¶code ./code ./main.js# ä½¿ç”¨ Typora æ‰“å¼€å½“å‰ç›®å½•æˆ–è€…æ–‡ä»¶typora.exe ./wsl.md ä½¿ç”¨ Dockerdocker desktop ç°åœ¨ä¹Ÿå·²ç»é’ˆå¯¹ WSL 2åšå‡ºäº†ä¼˜åŒ–ï¼Œå¯ä»¥ç›´æ¥å®‰è£… docker desktopã€‚ Docker Desktop WSL 2 backend ä¸€äº›é—æ†¾ systemctl å¯åŠ¨é€‰é¡¹æ— æ³•ä½¿ç”¨ï¼Œè™½ç„¶å¯ä»¥å€ŸåŠ©ç¬¬ä¸‰æ–¹æ–¹æ³•è¾¾æˆç›®çš„ WSL 2 ä¸€äº›å¯èƒ½ä¼šç”¨åˆ°çš„å‘½ä»¤ä½¿ç”¨ help æ¥äº†è§£å…¨éƒ¨å¯ç”¨çš„å‘½ä»¤ï¼š 1wsl --help å¦‚æœè¦æŸ¥çœ‹å·²ç»å®‰è£…çš„ Linux å­ç³»ç»Ÿæ‰€ä½¿ç”¨çš„ WSL ç‰ˆæœ¬ï¼š 12# åˆ—å‡ºå·²ç»å®‰è£…çš„ linux å­ç³»ç»Ÿï¼Œversion ä¸€åˆ—æŒ‡çš„æ˜¯ wsl çš„ç‰ˆæœ¬wsl -l -v å­ç³»ç»Ÿé»˜è®¤å®‰è£…åœ¨ C:\\ï¼Œå¦‚æœä½ è§‰å¾—å ç”¨çš„ç©ºé—´å¤ªå¤šï¼Œéœ€è¦è¿ç§»åˆ°åˆ«çš„ä½ç½®ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è§£å†³ï¼š 123456789101112131415161718192021222324# åœæ­¢ wsl è¿è¡Œwsl --shutdown# å¯¼å‡ºéœ€è¦è¿ç§»çš„å‘è¡Œç‰ˆï¼ŒæŒ‡å®šä¸€ä¸ªä¸´æ—¶å­˜æ”¾ä½ç½®å’Œæ–‡ä»¶å# wsl --export Ubuntu-20.04 d:\\temp\\wsl-Ubuntu-20.04.tarwsl --export &lt;Distro&gt; &lt;FileName&gt;# æ³¨é”€éœ€è¦è¿ç§»å¹¶ä¸”å·²ç»å¯¼å‡ºçš„å‘è¡Œç‰ˆ# wsl --unregister Ubuntu-20.04wsl --unregister &lt;Distro&gt;# å¯¼å…¥å‘è¡Œç‰ˆ# wsl --import Ubuntu-20.04 d:\\wsl\\Ubuntu-20.04 d:\\temp\\wsl-Ubuntu-20.04.tar --version 2wsl --import &lt;Distro&gt; &lt;InstallLocation&gt; &lt;FileName&gt; [--version &lt;WSL Version&gt;]# è¿è¡Œè¿ç§»åçš„å‘è¡Œç‰ˆ# wsl --distribution Ubuntu-20.04wsl --distribution &lt;Distro&gt;# æ­¤æ—¶ï¼Œè¿ç§»åçš„ç³»ç»Ÿä½¿ç”¨çš„æ˜¯ root ç”¨æˆ·åœ¨è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹é»˜è®¤ç”¨æˆ·# Ubuntu2004 æ˜¯åˆšåˆšå¯¼å…¥çš„å‘è¡Œç‰ˆå»æ‰æ ‡ç‚¹çš„åç§°# å¯ä»¥åœ¨ `%LocalAppData%\\Microsoft\\WindowsApps` æ‰¾åˆ°ã€‚# username æ˜¯å¯¼å‡ºä¹‹å‰ï¼Œä½ åœ¨å­ç³»ç»Ÿé‡Œä½¿ç”¨çš„ç”¨æˆ·çš„ç”¨æˆ·åï¼Œå¯†ç ä¹Ÿä¿æŒä¸å˜ubuntu2004 config --default-user &lt;username&gt; Hyper-V åŠ¨æ€ç«¯å£å ç”¨è¿‡å¤šçš„é—®é¢˜ å¦‚æœæœ‰ä½¿ç”¨åˆ° Hyper-V çš„æœ‹å‹ï¼Œè¦æå‰è€ƒè™‘ä¸€ä¸‹ windows åŠ¨æ€ç«¯å£å ç”¨è¿‡å¤šçš„é—®é¢˜ã€‚å¯ä»¥åœ¨å®‰è£… Hyper-Vä¹‹å‰ï¼Œå…ˆæŒ‡å®šåŠ¨æ€ç«¯å£çš„èŒƒå›´ï¼Œä»¥é¿å…ç«¯å£å ç”¨è¿‡å¤šï¼Œå·²ç»å®‰è£…çš„ç¨‹åºæˆ–è€…é¡¹ç›®è·‘ä¸èµ·æ¥ã€‚ 12345678910111213# ä»¥ç®¡ç†å‘˜æ¨¡å¼æ‰“å¼€ powershell# æŸ¥çœ‹ç«¯å£å ç”¨ interface/int# netsh interface ipv4 show tcp# æŸ¥çœ‹é»˜è®¤åŠ¨æ€ç«¯å£å ç”¨è®¿é—®netsh int ipv4 show dynamicport tcp# æŸ¥çœ‹è¢«å ç”¨ç«¯å£æ˜¯å¦åœ¨ hyper-v é¢„ç•™çš„èŒƒå›´å†…netsh int ipv4 show excludedportrange protocol=tcp# æŒ‰éœ€æ±‚æŒ‡å®šåŠ¨æ€ç«¯å£èŒƒå›´netsh int ipv4 set dynamicport tcp start=49152 num=16384# æˆ–è€…netsh int ip set dynamicport tcp start=49152 num=16384# è®¾ç½®å¥½åï¼Œé‡å¯ç”µè„‘ï¼ŒHyper-V å°±ä¼šä» 49152~65535 çš„èŒƒå›´å†…ä¿ç•™ä¸€éƒ¨åˆ†ç«¯å£ã€‚ é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿæ–‡æ¡£ å®‰è£… Terminalè¯´åˆ°è¿˜åŸå·¥ä½œç¯å¢ƒï¼Œå†™ä»£ç çš„åº”è¯¥ä¸ä¼šåªæœ‰æˆ‘ä¸€ä¸ªäººæ˜¯ä»ç»ˆç«¯å¼€å§‹çš„å§ï¼Ÿ Mac ä¸Šä¹ æƒ¯ä½¿ç”¨çš„ç»ˆç«¯æ˜¯ iTerm2ï¼Œåˆšå¥½å¾®è½¯ä¹Ÿæäº†ä¸ªè¯„ä»·ä¸é”™çš„ç»ˆç«¯ï¼Œè¿˜æ˜¯ä¸ªå¼€æºçš„ï¼Œå†ä¹Ÿä¸ç”¨ä¸€ç›´çœ‹ç€ç”µè„‘ä¸Šé‚£ä¸ª cmd å’Œ powershelläº†ã€‚ å®‰è£… Windows Terminal éå¸¸ç®€å•ï¼Œæ‰“å¼€ Microsoft Storeï¼Œæœç´¢ windows terminalï¼Œæ‰¾åˆ°é‚£ä¸ªåå­—ä¸å¸¦ preview çš„ï¼Œç›´æ¥å®‰è£…å°±è¡Œäº†ã€‚ æœ‰äº† Windows Terminal å°±æœ‰äº†ä¸€ä¸ªå¥½å¼€ç«¯ã€‚è¿è¡Œ Windows Terminal åï¼Œé»˜è®¤æ‰“å¼€çš„å¯èƒ½æ˜¯ PowerShellï¼Œåœ¨ PowerShell ä¸­ç›´æ¥è¾“å…¥ bash å¯ä»¥ç›´æ¥è¿›å…¥ wsl çš„ shell ç¯å¢ƒã€‚ åœ¨é¡¶éƒ¨æ ‡ç­¾æ çš„å³ä¾§ï¼Œæœ‰ä¸ªä¸‹æ‹‰ç®­å¤´ï¼Œé‡Œé¢å¯ä»¥é€‰æ‹©è¦æ‰“å¼€çš„ shell ä¹Ÿå¯ä»¥å¯¹ç»ˆç«¯è¿›è¡Œé…ç½®ã€‚å¦‚æœä½ å®‰è£…äº†æ–°çš„ shell ç¯å¢ƒæˆ–è€…æ–°çš„ wsl å‘è¡Œç‰ˆï¼Œè€Œç»ˆç«¯æ²¡æœ‰æ‰¾åˆ°ï¼Œå¯ä»¥è‡ªå·±æ·»åŠ æˆ–è€…ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶ã€‚å¦‚æœæ‰‹åŠ¨æ–°å¢ shell åˆ—è¡¨ï¼Œå¯ä»¥éœ€è¦å¡«å†™ guid ï¼Œå¯ä»¥ä½¿ç”¨ GUID / UUID generator ç”Ÿæˆä¸€ä¸ªã€‚ å¦å¤–ï¼Œä½ å¯èƒ½å¯¹ Windows Terminal æ·±åº¦é…ç½®æˆ–è€…ç¾åŒ–æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥çœ‹çœ‹ Windows Terminalç¾åŒ–ï¼Œä¼˜é›…çš„åŠå…¬å¸¦æ¥è¶…é«˜çš„æ•ˆç‡ ã€‚ æœ€åï¼Œé¡ºä¾¿æ¨èä¸‹å¾®è½¯çš„ PowerToys ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦è¿˜åŸåœ¨ Mac ä¸Šç©ºæ ¼é¢„è§ˆã€Alfread ç­‰ä¾¿åˆ©æ“ä½œã€‚ Shellæˆ‘åœ¨ Mac ä¸Šä½¿ç”¨çš„ shell æ˜¯ zshï¼Œæ‰€ä»¥è¿›å…¥ WSL åï¼Œéšå³å°±æŠŠ shell åˆ‡æ¢ä¸º zshã€‚ 123456789101112# æŸ¥çœ‹ç³»ç»Ÿä¸­æœ‰å“ªäº› shellcat /etc/shells# å¦‚æœæ²¡çœ‹åˆ°æœ‰ zshï¼Œé‚£å°±å®‰è£…ä¸€ä¸ªå§# æƒ¯ä¾‹ï¼Œå…ˆæŠŠä¾èµ–ä»€ä¹ˆçš„æ›´æ–°ä¸€ésudo apt update &amp;&amp; sudo apt upgrade# å®‰è£… zshsudo apt-get install zsh# æŠŠ shell åˆ‡æ¢ä¸º zshchsh -s /bin/zsh# é‡å¯ WSL è®© zsh ç”Ÿæ•ˆsudo reboot åˆ‡æ¢ä¸º zsh åï¼Œä¸ºäº†è®© zsh æ›´ä¸æ»‘ï¼Œæ¥ç€å®‰è£… oh-my-zsh 1234# install oh-my-zsh via curl$ sh -c \"$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"# install oh-my-zsh via wget$ sh -c \"$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)\" æœ€åï¼Œoh-my-zsh çš„é…ç½®ï¼Œä» Mac ä¸ŠåŸæ ·æ¬è¿‡æ¥å°±å¯ä»¥ç”¨äº†ã€‚ ç‰¹åˆ«çš„ä¸€ç‚¹ï¼Œå¦‚æœè¦åœ¨ WSL ä¸­æ‰“å¼€ windows çš„ä¸€äº›è½¯ä»¶ï¼Œæ¯æ¬¡éƒ½è¦è¾“å…¥ softwareName.exe è¿™æ ·çš„ä¸€é•¿ä¸²ï¼Œéå¸¸çƒ¦ã€‚å¥½åœ¨å¯ä»¥ç›´æ¥åœ¨ .zshrc ä¸­è®¾ç½®åˆ«åæ¥ä½¿ç”¨ã€‚ 123export PATH=$PATH:'/mnt/c/Program Files/Typora'# aliasesalias typora=\"Typora.exe\" Package managementåœ¨ Mac ä¸Šæ˜¯æˆ‘æ˜¯ç”¨æƒ¯äº† homebrewï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©åœ¨ WSL é‡Œä¹Ÿè£…ä¸Šä¸€ä»½ã€‚ 1/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\" å¦‚æœå®‰è£…åå‘ç° brew å‘½ä»¤ä¸èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œå…ˆç¡®è®¤å½“å‰ shell çš„é…ç½®é‡Œæ˜¯å¦æœ‰å¯¼å‡º homebrew çš„è·¯å¾„ã€‚ç”±äº homebrew åœ¨ WSL ä¸­çš„å®‰è£…è·¯ç”±åœ¨ /home/linuxbrew/.linuxbrew ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†ä¸ä¼šå‡ºç°åœ¨ path é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆåœ¨ .profile é‡Œå¯¼å‡ºï¼š 12export BREW_HOME=\"/home/linuxbrew/.linuxbrew/bin\"export PATH=\"$PATH:$BREW_HOME\" é‡è½½é…ç½®ååº”è¯¥èƒ½è§£å†³é—®é¢˜ï¼š 1source ~/.zshrc è§£å†³æ–¹æ³•æ¥è‡ªè¿™é‡Œï¼šhttps://stackoverflow.com/questions/64680855/how-to-install-homebrew-on-windows-wsl-ubuntu-and-fix-zsh-brew-command-not-fo windows ä¸Šçš„åŒ…ç®¡ç†ï¼Œå…¶å®è¿˜æ˜¯æœ‰å¥½å‡ ä¸ªçš„ï¼Œä¸è¿‡ä¹‹å‰éƒ½æ˜¯ç¬¬ä¸‰æ–¹çš„åŒ…ç®¡ç†ï¼Œç°åœ¨å¾®è½¯è‡ªå·±å¼„äº†ä¸€ winget ï¼Œè™½ç„¶ä¸Šé¢çš„è½¯ä»¶ç°åœ¨è¿˜ä¸å¤šï¼Œä¸è¿‡è¿˜æ˜¯èƒ½æ»¡è¶³æˆ‘çš„éœ€æ±‚çš„ã€‚ å®‰è£…æ–¹æ³•å°±ä¸å¤šè¯´äº†ï¼Œç›´æ¥çœ‹å®˜æ–¹æ–‡æ¡£ ä½¿ç”¨ winget å·¥å…·å®‰è£…å’Œç®¡ç†åº”ç”¨ç¨‹åº ã€‚ Source Code Editor &amp; Pluginså› ä¸ºæˆ‘ç”¨çš„æ˜¯ vs code å…¶ä»–çš„ IDE æˆ‘ä¹Ÿä¸æ¸…æ¥šæ˜¯ä»€ä¹ˆæƒ…å†µï¼Œå°±ä¸å¤šè¯´ã€‚ vs code è£…å¥½åï¼Œè®°å¾—æŠŠ Remote - WSL è¿™ä¸ªæ’ä»¶è£…ä¸Šï¼Œå®ƒå¯ä»¥è®©ä½ ç›´æ¥åœ¨å®¿ä¸»æœºä¸Šç¼–è¾‘ WSL ä¸­çš„æ–‡ä»¶ã€‚ å¦å¤–ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ç›´æ¥åœ¨ windows é‡Œ git clone ä»»ä½•è¿œç¨‹é¡¹ç›®ï¼Œä¸ºäº†ä¿æŒå„æ–¹é¢çš„å­—ç¬¦ç¼–ç ç»Ÿä¸€ï¼Œè¯·åœ¨ WSL é‡Œ git clone è¿œç¨‹é¡¹ç›®ï¼Œæ–°é¡¹ç›®ä¹Ÿå»ºè®®ä½ åœ¨ WSL é‡Œå»ºç«‹ã€‚ Whatâ€™s next?ä¸ºäº†é¿å…å†ç»§ç»­å†™ä¸€äº›å†—é•¿æ— æ„ä¹‰çš„å†…å®¹ï¼Œæˆ‘å†³å®šå°±æ­¤æ‰“ä½ã€‚ç›¸ä¿¡æŒ‰ä¸Šé¢çš„æŒ‡å¼•ï¼Œåº”è¯¥å¯ä»¥å¸®åŠ©åˆ°é¿å…ä¸€äº›ä» Mac è½¬åˆ° Windows çš„éº»çƒ¦ï¼ŒèŠ‚çœä½ çš„æ—¶é—´ã€‚ å¦‚æœæˆ‘åœ¨ WSL ä¸Šçš„å·¥ä½œç¯å¢ƒæœ‰ä»»ä½•æœ‰æ„ä¹‰çš„å˜åŒ–ï¼Œæˆ‘ä¹Ÿä¼šç»§ç»­æ›´æ–°æœ¬æ–‡ï¼Œä»¥ä¿è¯å†…å®¹å¯ä»¥è·Ÿä¸Šå˜åŒ–ã€‚","link":"/Notes/guide-for-changing-dev-environment-from-mac-to-windows/"},{"title":"åœ¨ vue-element-admin æ€æ ·åŠ¨æ€ç”Ÿæˆè·¯ç”±é…ç½®ï¼Ÿ","text":"èµ·å› äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œé¡¹ç›®é‡Œéœ€è¦å¯¹è·¯ç”±å’ŒæŒ‰é’®é…ç½®æƒé™ï¼Œæ‰€ä»¥ä¼šæ¶‰åŠåˆ°åŠ¨æ€è¾“å‡ºè·¯ç”±çš„é—®é¢˜ï¼Œç„¶åå‰ç«¯ç”¨çš„æ˜¯ vue-element-admin ï¼Œçœ‹é¡¹ç›®é‡Œæ˜¯æ”¯æŒåŠ¨æ€åŠ è½½çš„ï¼Œä½†æ˜¯å®˜æ–¹æ–‡æ¡£é‡Œå¯¹è¿™å—è¯´å¾—â€¦ç®—æ˜¯è¯­ç„‰ä¸è¯¦å§ã€‚ ç„¶åæˆ‘ç¿»äº†ç¿» issue æŒºå¤šäººåœ¨é—®çš„ï¼Œä¹Ÿæœ‰ä¸å°‘äººç»™å‡ºäº†è§£å†³æ–¹æ¡ˆã€‚å—¯ï¼Œæˆ‘æƒå½“æ•´ç†ä¸€ä¸‹ï¼Œæ€•å¹´çºªå¤§å®¹æ˜“å¿˜ã€‚ æ€è·¯å› ä¸º vue-element-admin ä¸»è¦æ˜¯ç”¨äºåå°ç®¡ç†çš„æ¡†æ¶ï¼Œæ‰€ä»¥è®¿é—®æµç¨‹å¤§è‡´æ˜¯è¿™æ ·å­çš„ï¼š å‘é€ç™»å½•è¯·æ±‚ éªŒè¯æˆåŠŸï¼Œè¿”å› token æ ¹æ® token è¿”å›å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬å½“å‰ç”¨æˆ·çš„è§’è‰²ï¼Œä»¥åŠæ‰€å±è§’è‰²èƒ½è®¿é—®çš„è·¯ç”± å‰ç«¯åˆ›å»ºä¸€ä¸ªè·¯ç”±ç»„ä»¶æ˜ å°„è¡¨ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†åç«¯è¿”å›çš„ component çš„å€¼æ›¿æ¢ä¸ºå¯æ‰§è¡Œçš„å¯¹è±¡ å°†æ¸…æ´—è¿‡çš„è·¯ç”±è¡¨å’Œå‰ç«¯å­˜åœ¨çš„è·¯ç”±è¡¨åˆå¹¶ é‡è½½è·¯ç”±è¡¨ï¼Œå®Œæˆ å…¶å®æ ¸å¿ƒåœ¨ä¸Šé¢çš„ç¬¬ 4 æ¡ã€‚æ ¹æ®é¡¹ç›® issue é‡Œä½œè€…å’Œå…¶ä»–äººæä¾›çš„æ–¹æ³•ï¼Œæœ‰ä¸¤ç§æ˜ å°„è¡¨çš„åˆ›å»ºæ–¹å¼ï¼š å‰ç«¯åˆ›å»ºåˆ›å»ºä¸€ä»½é™æ€çš„è·¯ç”±ç»„ä»¶æ˜ å°„è¡¨ æ ¹æ®åç«¯è¿”å›çš„è·¯ç”±è¡¨åŠ¨æ€æ›¿æ¢ æˆ‘ä¸ªäººå€¾å‘äºå‘åç«¯å½•å…¥ä¸€ä»½è·¯ç”±è¡¨ï¼Œç„¶åå†åŠ¨æ€åŒ¹é…ã€‚è¿™æ ·å­åªéœ€è¦ç»´æŠ¤ä¸€ä»½è·¯ç”±è¡¨ï¼Œè€Œä¸æ˜¯ä¸€ä»½è·¯ç”±è¡¨å’Œä¸€ä»½è·¯ç”±ç»„ä»¶æ˜ å°„è¡¨ã€‚ æˆ‘ç›®å‰åœ¨ä½¿ç”¨çš„ vue-element-admin ç‰ˆæœ¬ï¼Œå¯èƒ½å’Œ issue é‡Œå¤§å®¶è®¨è®ºæ—¶çš„ç‰ˆæœ¬æœ‰æ¯”è¾ƒå¤§çš„å·®å¼‚ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„è¿‡ç¨‹å’Œä»£ç ï¼Œå»ºç«‹åœ¨ vue-element-admin version: 4.2.1 ä¸Šã€‚ å‡†å¤‡å·¥ä½œï¼šè·¯ç”±è¡¨çš„å‰ç«¯ç»“æ„å’Œæ•°æ®åº“ä¸­æ•°æ®ç»“æ„è·¯ç”±è¡¨çš„å‰ç«¯ç»“æ„å…ˆæ¥çœ‹çœ‹æ¡†æ¶çš„è·¯ç”±è¡¨é•¿å•¥æ ·ã€‚ 123456789101112131415161718192021{ path: '/example', component: Layout, redirect: '/example/table', name: 'Example', meta: { title: 'Example', icon: 'example', roles: ['admin', 'editor'] }, children: [ { path: 'tree', name: 'Tree', component: () =&gt; import('@/views/tree/index'), meta: { title: 'Tree', icon: 'tree' } }, { path: 'form', name: 'Form', component: () =&gt; import('@/views/form/index'), meta: { title: 'Form', icon: 'form' } } ]} è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰ä¸¤ä¸ªå­èœå•é¡¹çš„è·¯ç”±è¡¨ã€‚ä¸‹é¢è¿™ä¸ªæ˜¯å¦ä¸€ç§å½¢å¼çš„ã€‚ 12345678910111213{ path: '/icon', component: Layout, alwaysShow: true, children: [ { path: 'index', component: () =&gt; import('@/views/icons/index'), name: 'Icons', meta: { title: 'icons', icon: 'icon', noCache: true } } ]} è¿™æ˜¯ä¸ªåªæ˜¾ç¤ºä¸€ä¸ªä¸»èœå•è€Œæ²¡æœ‰å­èœå•é¡¹çš„è·¯ç”±è¡¨ã€‚å½“ç„¶ï¼Œæ¡†æ¶ä¸­å¹¶ä¸åªè¿™ä¸¤ç§æ–¹å¼ï¼Œè¿™åªæ˜¯æˆ‘ä»¬éœ€è¦çš„ä¸¤ç§æ–¹å¼ã€‚ æç¤ºï¼šå†ç•™æ„ä¸€ä¸‹è¿™ä¸¤æ®µæ•°æ®ä¸­ï¼Œéƒ½æœ‰ä¸ªå« component çš„å­—æ®µï¼Œè¡¨ç¤ºçš„æ˜¯ï¼Œè·¯ç”±ç»‘å®šçš„è§†å›¾ï¼Œè¿™ä¸ªåº”è¯¥éƒ½çœ‹å¾—æ‡‚ä¸ç”¨å¤šä½œè§£é‡Šäº†ã€‚ç„¶åè¿™é‡Œå°±æ˜¯åŠ¨æ€ç”Ÿæˆè·¯ç”±è¡¨çš„å…³é”®ä¹‹å¤„ã€‚æˆ‘æŠŠè¿™ä¸ªå­—æ®µçš„æ„æ€è¡¨ç¤ºä¸º è·¯ç”±ç»„ä»¶æ˜ å°„ ã€‚ component çš„å€¼ï¼Œå¦‚æœæ˜¯ä»åç«¯è¿”å›çš„ï¼Œä¸€å®šä¼šæ˜¯å­—ç¬¦ä¸²ï¼Œè€Œä¸”è¿™æ—¶å€™ï¼Œå‰ç«¯ä»£ç ä¹Ÿå·²ç»ç”± webpack æ‰“åŒ…å¥½äº†ï¼Œæ‰€ä»¥æ²¡åŠæ³•èµ·ä½œç”¨ã€‚é‚£ä¹ˆå°±éœ€è¦ç”¨æ˜ å°„è¡¨çš„æ–¹æ³•ï¼Œå¼‚æ­¥åŠ è½½ï¼Œè®©è§†å›¾ç”Ÿæ•ˆï¼Œä»è€Œå®ç°åŠ¨æ€åŠ è½½è·¯ç”±éœ€æ±‚ã€‚ è·¯ç”±è¡¨åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®ç»“æ„é‚£ä¹ˆè¦æŠŠè·¯ç”±å’Œæƒé™ç»“åˆèµ·æ¥ï¼Œå½“ç„¶ä¸èƒ½çº¯äººå·¥å»ç»´æŠ¤ï¼Œæ‰€ä»¥è¦åœ¨åç«¯ä¿å­˜ä¸€ä»½è·¯ç”±è¡¨ï¼Œè€Œä¸”è¿˜æŒ‡å®šäº†æƒé™è§’è‰²çš„ã€‚ç¿»çœ‹äº† vue-element-admin çš„æ–‡æ¡£å’Œä»£ç ï¼Œå‘ç°è·¯ç”±æ”¯æŒæ·±åº¦åµŒå¥—ï¼Œè€Œä¸”çˆ¶ã€å­è·¯ç”±çš„ç»“æ„æ˜¯é«˜åº¦ç›¸ä¼¼çš„ï¼Œå¹¶æ²¡æœ‰åšä¸€ä¸ªæ˜æ˜¾çš„åŒºåˆ†ï¼ŒåŸºäºè¿™ä¸ªåŸå› ï¼Œçˆ¶å­çš„æ•°æ®ç»“æ„å°†æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œå…¶ä¸­åªæœ‰ä¸¤ä¸ªå­—æ®µçš„èµ‹å€¼åŒºåˆ«ï¼Œä¸‹é¢å†è¯´ã€‚ é‰´äºæ­¤ï¼Œä»¥åŠæ¡†æ¶æ”¯æŒè·¯ç”±æ·±åº¦åµŒå¥—ï¼Œæ‰€ä»¥æœ€åçš„èœå•é¡¹ï¼Œéƒ½å¯èƒ½æ˜¯åˆ«çš„èœå•çš„çˆ¶æˆ–è€…å­ã€‚è¿™æ–¹é¢åœ¨è¿™ç¯‡æ–‡ä¸æ·±å…¥è®¨è®ºã€‚ å› ä¸ºæˆ‘ç”¨çš„ mongodb ï¼Œæˆ‘è¿˜æ˜¯å¸Œæœ›ç”¨æ¯”è¾ƒå¹³çš„ç»“æ„æ¥å¤„ç†è·¯ç”±ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ schema å®šä¹‰ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142const MenuSchema = new mongoose.Schema({ __v: { type: Number, select: false }, name: { type: String, required: true }, //è®¾å®šè·¯ç”±çš„åå­—ï¼Œä¸€å®šè¦å¡«å†™ä¸ç„¶ä½¿ç”¨&lt;keep-alive&gt;æ—¶ä¼šå‡ºç°å„ç§é—®é¢˜ path: { type: String, required: true }, component: { type: String, default: 'Layout' }, redirect: { type: String, default: 'noRedirect' }, //é‡å®šå‘åœ°å€ï¼Œåœ¨é¢åŒ…å±‘ä¸­ç‚¹å‡»ä¼šé‡å®šå‘å»çš„åœ°å€ hidden: { type: Boolean, default: false }, // ä¸åœ¨ä¾§è¾¹æ æ˜¾ç¤º // å½“ä½ ä¸€ä¸ªè·¯ç”±ä¸‹é¢çš„ children å£°æ˜çš„è·¯ç”±å¤§äº1ä¸ªæ—¶ï¼Œè‡ªåŠ¨ä¼šå˜æˆåµŒå¥—çš„æ¨¡å¼--å¦‚ç»„ä»¶é¡µé¢ // åªæœ‰ä¸€ä¸ªæ—¶ï¼Œä¼šå°†é‚£ä¸ªå­è·¯ç”±å½“åšæ ¹è·¯ç”±æ˜¾ç¤ºåœ¨ä¾§è¾¹æ --å¦‚å¼•å¯¼é¡µé¢ // è‹¥ä½ æƒ³ä¸ç®¡è·¯ç”±ä¸‹é¢çš„ children å£°æ˜çš„ä¸ªæ•°éƒ½æ˜¾ç¤ºä½ çš„æ ¹è·¯ç”± // ä½ å¯ä»¥è®¾ç½® alwaysShow: trueï¼Œè¿™æ ·å®ƒå°±ä¼šå¿½ç•¥ä¹‹å‰å®šä¹‰çš„è§„åˆ™ï¼Œä¸€ç›´æ˜¾ç¤ºæ ¹è·¯ç”± alwaysShow: { type: Boolean, default: true }, //ä¸€ç›´æ˜¾ç¤ºæ ¹è·¯ç”± meta: { role: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Role', }], //è®¾ç½®è¯¥è·¯ç”±è¿›å…¥çš„æƒé™ï¼Œæ”¯æŒå¤šä¸ªæƒé™å åŠ ã€‚ä½ å¯ä»¥åœ¨æ ¹è·¯ç”±è®¾ç½®æƒé™ï¼Œè¿™æ ·å®ƒä¸‹é¢æ‰€æœ‰çš„å­è·¯ç”±éƒ½ç»§æ‰¿äº†è¿™ä¸ªæƒé™ title: { type: String, required: true }, //è®¾ç½®è¯¥è·¯ç”±åœ¨ä¾§è¾¹æ å’Œé¢åŒ…å±‘ä¸­å±•ç¤ºçš„åå­— icon: { type: String }, //è®¾ç½®è¯¥è·¯ç”±çš„å›¾æ ‡ noCache: { type: Boolean, default: false }, //å¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™ä¸ä¼šè¢« &lt;keep-alive&gt; ç¼“å­˜(é»˜è®¤ false) breadcrumb: { type: Boolean, default: true }, // å¦‚æœè®¾ç½®ä¸ºfalseï¼Œåˆ™ä¸ä¼šåœ¨breadcrumbé¢åŒ…å±‘ä¸­æ˜¾ç¤º }, children: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Menu', autopopulate: { maxDepth: 3 } }], extra: { type: mongoose.Schema.Types.Mixed }, createdAt: { type: Date, default: Date.now }}, { id: false, toObject: { virtuals: true }, toJSON: { virtuals: true }})MenuSchema.virtual('meta.roles', { ref: 'Role', localField: 'meta.role', foreignField: '_id', justOne: false, autopopulate: { select: 'name', maxDepth: 1 }})MenuSchema.plugin(require('mongoose-autopopulate')) æ³¨æ„ï¼šè¿™é‡Œè¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼Œå› ä¸ºè¿™é‡Œçš„è·¯ç”±è¡¨æ˜¯æ ‘çŠ¶ç»“æ„ï¼Œæœ€æœ«å°¾çš„å¶å­ï¼Œä¹Ÿå°±æ˜¯æœ€åº•å±‚çš„ child å’Œ parent ä¸­æœ‰ä¸¤ä¸ªå­—æ®µçš„å€¼æ˜¯æœ‰åŒºåˆ†çš„ã€‚ä¸€ä¸ªæ˜¯ alwaysShowï¼Œå¦‚æœæ˜¯å¶å­å»ºè®®è®¾ç½®ä¸º false ï¼›å¦ä¸€ä¸ªæ˜¯redirectï¼Œåœ¨å‰ç«¯åšæ•°æ®æ¸…æ´—çš„æ—¶å€™ï¼Œå¶å­ä¸­çš„è¿™ä¸ªå€¼ä¸€å®šè¦è®¾ç½®ä¸º fasleï¼ŒalwaysShow å¯ä»¥ä¸è®¾ç½®ï¼Œä½†æ˜¯è¿™é¡¹ä¸€å®šè¦è®¾ç½®ã€‚ åˆ°è¿™é‡Œï¼Œå‰ç«¯åç«¯çš„è·¯ç”±è¡¨ç»“æ„å°±éƒ½æ¸…æ¥šäº†ã€‚ è¿˜æœ‰ä¸€ç‚¹é¡ºå¸¦æä¸€ä¸‹ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ˜¾ç¤ºæ—¶æ²¡æœ‰å­èœå•çš„èœå•é¡¹ï¼Œæ•°æ®é‡Œï¼Œçˆ¶é¡¹æ˜¯ä¸ç”¨è®¾ç½® name çš„. å»ºç«‹è·¯ç”±ç»„ä»¶æ˜ å°„è¡¨å¯¹äºè¿™ä¸ªæ˜ å°„è¡¨ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§å¸¸ç”¨çš„æ–¹æ³•æ¥è§£å†³ã€‚ ç”±å‰ç«¯ç»´æŠ¤ä¸€ä»½é™æ€è·¯ç”±ç»„ä»¶æ˜ å°„è¡¨è¿™æ˜¯äº¤ç”±å‰ç«¯æ¥ç»´æŠ¤çš„ä¸€ä»½ä¸åç«¯ä¸€æ ·çš„ç»„ä»¶æ˜ å°„è¡¨ã€‚ # src/router/index.js1234export const routerMap={ 'Tree': () =&gt; import('@/views/tree/index'), 'Form': () =&gt; import('@/views/form/index')} é¢å¯¹è¿™ä»½è·¯ç”±ç»„ä»¶æ˜ å°„è¡¨ï¼Œå®åœ¨æ˜¯é«˜å…´ä¸èµ·æ¥ã€‚æ—¢ç„¶åç«¯å·²ç»ä¿å­˜æœ‰ä¸€ä»½äº†ï¼Œä½•è‹¦å†æ¥æ‰‹åŠ¨ç»´æŠ¤ä¸€ä»½æ˜ å°„è¡¨å‘¢ï¼Ÿæ‰€ä»¥è¿˜æ˜¯å†™ä¸ªæ–¹æ³•ï¼Œæ¯æ¬¡è·å¾—è·¯ç”±è¡¨çš„æ—¶å€™ï¼Œéƒ½è‡ªåŠ¨å»åŒ¹é…ä¸€æ¬¡å°±å¥½ã€‚æ‰€ä»¥ä¹Ÿå°±æœ‰äº†ä¸‹é¢è¿™ä¸ªåŠ¨æ€æ›¿æ¢çš„æ–¹æ³•ã€‚ æ ¹æ®åç«¯è¿”å›çš„è·¯ç”±è¡¨åŠ¨æ€æ›¿æ¢è·¯ç”±ç»„ä»¶æ˜ å°„å¼€å‘äººå‘˜éƒ½æ˜¯è¦æƒ³åŠæ³•å·æ‡’çš„ï¼Œè¦ä¸ç„¶ä¸ä¼šæœ‰æŠ€æœ¯çš„è¿›æ­¥ã€‚æ‰€ä»¥æˆ‘ä»¬å†³å®šæ”¾å¼ƒæ‰‹åŠ¨ç»´æŠ¤ä¸€ä»½æ˜ å°„è¡¨ã€‚ # src/store/modules/user.js12345678910111213141516171819202122232425262728293031323334353637383940/* Layout */import Layout from '@/layout'/** * åŠ¨æ€ç”Ÿæˆè·¯ç”±ç»„ä»¶æ˜ å°„è¡¨å¹¶æ›¿æ¢ * * @param {Array} serverRouterMap * @returns */function serverRouterMap(serverRouter) { const res = [] serverRouter.forEach(item =&gt; { const router = { ...item } if (router.component === 'Layout') { // Layout è¦é¢„å…ˆ import è¿›æ¥ router.component = Layout } else { let views = router.component views = views.replace(/^\\/*/g, '') // å¼‚æ­¥åŠ è½½è§†å›¾ // router.component = () =&gt; import(`@/views/${views}`) // æ›´æ–°äº†æŸä¸ªç‰ˆæœ¬çš„ webpack åï¼Œåªèƒ½ç”¨è¿™ç§å†™æ³•äº† router.component = (resolve) =&gt; require([`@/views/${views}`], resolve) } if (router.children &amp;&amp; router.children.length &gt; 0) { router.children = serverRouterMap(router.children) } // å¦‚æœæ˜¯æœ€åçš„å¶å­èŠ‚ç‚¹ï¼ŒæŠŠ redirect è®¾ç½®ä¸º false if (router.redirect === 'noRedirect' &amp;&amp; router.children &amp;&amp; router.children.length === 0) { router.redirect = false } res.push(router) }) return res} åˆ°è¿™é‡Œï¼Œä¸»è¦çš„æ–¹æ³•å°±æå®šäº†ï¼Œæ¥ä¸‹æ¥æŒ‰ç™»å½•çš„æµç¨‹æ¥ç”ŸæˆåŠ¨æ€è·¯ç”±ã€‚ ç”ŸæˆåŠ¨æ€è·¯ç”±è¦ç”ŸæˆåŠ¨æ€è·¯ç”±ï¼Œè¿˜æ˜¯è¦å…ˆæ‹¿åˆ°æ•°æ®ã€‚åœ¨ src/store/modules/user.js çš„ actions é‡Œæ‰¾åˆ° getInfoæ–¹æ³•ï¼Œå› ä¸ºå’Œå½“å‰ç”¨æˆ·ç›¸å…³çš„æ•°æ®ï¼Œéƒ½æ˜¯ä»è¿™é‡Œæ‹¿çš„ã€‚ # src/store/modules/user.js12345// ä»è¿”å›çš„æ•°æ®ä¸­æ‹¿åˆ° routes æ•°æ®const { roles: role, username, avatar, routes } = data// ç„¶ååœ¨åˆé€‚çš„åœ°æ–¹ï¼Œè°ƒç”¨ serverRouterMap() æ–¹æ³•ï¼Œæ¸…æ´—å¹¶åŒ¹é…è·¯ç”±ç»„ä»¶æ˜ å°„åï¼Œé‡æ–°èµ‹å€¼ç»™ data.routesdata.routes = serverRouterMap(routes) æ¥ä¸‹æ¥ï¼Œå°å°ä¿®æ”¹ä¸€ä¸‹ generateRoutes() æ–¹æ³•ã€‚ä¿®æ”¹äº†æ¥æ”¶çš„å‚æ•°ä»¥åŠè·¯ç”±æ•°æ®çš„æ¥æºï¼Œå’Œä½ æœ¬åœ°æ²¡ä¿®æ”¹è¿‡çš„æ–¹æ³•ï¼Œå¯¹ç…§ç€æ”¹å§ã€‚ # src/store/modules/permission.js12345678910111213141516171819202122generateRoutes({ commit }, data) { return new Promise(resolve =&gt; { let accessedRoutes const { routes: serverAsyncRouterMap, roles } = data // generateRoutes åŸæ¥çš„å†™æ³• // if (roles.includes('admin')) { // accessedRoutes = asyncRoutes || [] // } else { // accessedRoutes = filterAsyncRoutes(asyncRoutes, roles) // } // è·å–åŠ¨æ€è·¯ç”±çš„å†™æ³• if (roles.includes('admin')) { accessedRoutes = serverAsyncRouterMap } else { accessedRoutes = filterAsyncRoutes(serverAsyncRouterMap, roles) } commit('SET_ROUTES', accessedRoutes) resolve(accessedRoutes) })} æ¥ç€å°±è¦ dispatch generateRoutes æ¥ç”Ÿæˆè·¯ç”±å•¦ï¼ # src/permission.js123456789101112131415// get user info// ä¿®æ”¹å‰çš„æ ·å­// note: roles must be a object array! such as: ['admin'] or ,['developer','editor']const { roles } = await store.dispatch('user/getInfo')// generate accessible routes map based on rolesconst accessRoutes = await store.dispatch('permission/generateRoutes', roles)// ä¿®æ”¹åçš„æ ·å­// note: roles must be a object array! such as: ['admin'] or ,['developer','editor']const data = await store.dispatch('user/getInfo')// generate accessible routes map based on rolesconst accessRoutes = await store.dispatch('permission/generateRoutes', data) åˆ°è¿™é‡Œï¼Œå°±å…¨éƒ¨ç»“æŸäº†ã€‚ä¿å­˜åï¼Œé¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°æœ€æ–°çš„ç»“æœã€‚ issue ä¸­çš„ç›¸å…³è®¨è®ºæœ¬æ–‡çš„æ€è·¯æ¥æºäºä¸¤ä¸ª issue çš„è®¨è®ºã€‚ æ‰‹åŠ¨ç»´æŠ¤ä¸€ä»½è·¯ç”±ç»„ä»¶æ˜ å°„è¡¨ åŠ¨æ€åŒ¹é…è·¯ç”±ç»„ä»¶æ˜ å°„è¡¨ æœ€åï¼Œvue-element-admin çš„é¡¹ç›®åœ°å€ã€‚","link":"/Technology/Javascript/how-to-generate-dynamic-route-in-vue-element-admin-project/"},{"title":"Create video with Moviepy","text":"èµ·å› æœ€è¿‘åœ¨å­¦ scrapy çˆ¬è™«ï¼Œé¡ºæ‰‹ä»å¾®åšä¸Šçˆ¬äº†å¼ å­æ«å’Œè°­æ¾éŸµçš„å¾®åšç›¸ç‰‡ã€‚ç„¶åå°±æƒ³ï¼Œè¦ä¸å°±é¡ºæ‰‹ç”¨çˆ¬çš„ç›¸ç‰‡åšä¸ªè§†é¢‘å‡ºæ¥ï¼Ÿ éœ€æ±‚ï¼†æ€è·¯æˆ‘çš„æ€è·¯æ˜¯è¿™æ ·å­çš„ï¼š è¿™ä¸ªè§†é¢‘æ˜¯ 1080p 30fpsï¼› æˆ‘è¦ç»™è¿™ä¸ªè§†é¢‘é€‰ä¸€é¦–å¥½å¬çš„ BGMï¼Œç„¶åæ¯ä¸€å¹…ç›¸ç‰‡éƒ½æŒ‰ BGM çš„èŠ‚æ‹æ¥æ˜¾ç¤ºï¼› è§†é¢‘é•¿åº¦å’Œ BGM é•¿åº¦åŒ¹é…ï¼› è·å–ç›¸ç‰‡å¹¶å°†ç›¸ç‰‡åˆ†è¾¨ç‡å¤„ç†æˆå’Œè§†é¢‘ä¸€æ ·ï¼› æŒ‰èŠ‚æ‹åˆ›å»ºå‰ªè¾‘ç‰‡æ®µï¼› åˆå¹¶å‰ªè¾‘ï¼Œç”Ÿæˆè§†é¢‘ å‡†å¤‡å·¥ä½œ ç”±äºæˆ‘æœºå™¨ä¸Šä½¿ç”¨çš„æ˜¯ python 3 çš„ç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦æœ‰ python 3ã€‚ å»ºè®®åœ¨ python çš„è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œè¿™ä¸ªé¡¹ç›®ã€‚ åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£… moviepy librosa clickä¸‰ä¸ªåŒ…ã€‚ å¦‚æœè¦åŠ å­—å¹•ï¼Œè¿˜éœ€è¦å®‰è£… imagemagickã€‚ å¦‚æœéœ€è¦å¯¹å­—å¹•åšåˆ†è¯å¤„ç†ï¼Œå†å®‰è£…ä¸€ä¸ª jiebaã€‚ æˆ‘ç”¨çš„æ˜¯ macbookï¼Œæ‰€æœ‰çš„å‘½ä»¤éƒ½æ˜¯åœ¨ macos ç¯å¢ƒä¸­æ‰§è¡Œã€‚linux çš„è¿‡ç¨‹å¤§åŒå°å¼‚ï¼Œwindows ä¸‹éœ€è¦è‡ªè¡Œæå®š pythonã€‚ å…ˆåˆ†æä¸€ä¸‹æœ€ç»ˆçš„ç›®å½•ç»“æ„å’Œæ–‡ä»¶ 1234567891011.â”œâ”€â”€ ./createVideoWithMoviepy.py # è¿™ç¯‡è¦è®²çš„ä¸»è¦çš„ä¸œè¥¿â”œâ”€â”€ ./distâ”‚&nbsp;&nbsp; â””â”€â”€ ./dist/1353112775.mp4 # æœ€åç”Ÿæˆçš„è§†é¢‘ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºâ”œâ”€â”€ ./srcâ”‚&nbsp;&nbsp; â”œâ”€â”€ ./src/font # å¦‚æœè¦åŠ å­—å¹•ï¼Œè¿™é‡Œæ”¾å­—ä½“â”‚&nbsp;&nbsp; â”œâ”€â”€ ./src/images -&gt; ~/.../idols/images_origin # èµ„æºæºæ–‡ä»¶ç›®å½•ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªè½¯é“¾æ¥ï¼Œä¸‹æ–‡ä¼šè§£é‡Šâ”‚&nbsp;&nbsp; â”œâ”€â”€ ./src/imgs # å¤„ç†è¿‡çš„å›¾ç‰‡èµ„æºç›®å½•ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºâ”‚&nbsp;&nbsp; â”œâ”€â”€ ./src/music # BGM ç›®å½•â”‚&nbsp;&nbsp; â””â”€â”€ ./src/subtitles # å¦‚æœæœ‰å­—å¹•ï¼Œå­—å¹•çš„çº¯æ–‡æœ¬æ–‡æ¡£æ”¾åœ¨è¿™é‡Œâ””â”€â”€ ./utils.py # ä¸€äº›å·¥å…·è„šæœ¬ å‡è®¾ python3 ç¯å¢ƒå·²ç»å­˜åœ¨ã€‚ 12# åˆ›å»ºé¡¹ç›®ç›®å½•mkdir -p ./{moviepy/dist,moviepy/src/imgs,moviepy/src/music} å¯æœ‰æ³¨æ„åˆ°ï¼Œè¿™é‡Œæˆ‘æ²¡æœ‰åˆ›å»ºmoviepy/src/imagesè¿™ä¸ªç›®å½•ï¼Ÿç”±äºæˆ‘çˆ¬å–çš„ç›¸ç‰‡åœ¨å¦å¤–ä¸€ä¸ªé¡¹ç›®ç›®å½•é‡Œidols/images_originï¼Œæ‰€ä»¥è¿™é‡Œå°†åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥æ¥æŒ‡å‘æºç›®å½•ã€‚ 1234# è¿›å…¥ src ç›®å½•å¹¶è§‚å¯Ÿåˆ›å»ºè½¯é“¾æ¥å‰åï¼Œç›®å½•é‡Œçš„å˜åŒ–cd moviepy/src &amp;&amp; llln -s ~/idols/images_origin imagesll ç›®å½•æœ‰äº†ï¼Œæ¥ä¸‹æ¥å‡†å¤‡å¼€å‘ç¯å¢ƒã€‚ 1234567891011# å…ˆç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•ã€‚çº¦å®šï¼šä»¥ä¸‹æ“ä½œï¼Œå‡çº¦å®šåœ¨æˆ‘ä»¬çš„ moviepy é¡¹ç›®ç›®å½•ä¸­è¿›è¡Œã€‚cd moviepy# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒã€‚ç”±äºæˆ‘çš„ç³»ç»Ÿä¸­æœ‰ python2 å’Œ python3ã€‚python3 -m venv venv# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ. venv/bin/activate# å¦‚æœéœ€è¦é€€å‡ºè™šæ‹Ÿç¯å¢ƒï¼Œä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤# deactivate æ¥ä¸‹æ¥ï¼Œå®‰è£…æˆ‘ä»¬çš„ä¾èµ–moviepy librosa clickï¼Œå¦å¤–ï¼Œå¯èƒ½ä¼šéœ€è¦å¤„ç†å›¾ç‰‡ï¼Œéœ€è¦é¢å¤–å®‰è£…PILã€‚ 123pip install moviepy librosa click# é¢å¤–å®‰è£… PILpip install pillow æœ€åï¼Œåˆ›å»ºæˆ‘ä»¬çš„ä¸¤ä¸ªè„šæœ¬æ–‡ä»¶ 1touch createVideoWithMoviepy.py utils.py æ­£å¼å¼€å§‹è·å–åˆ›å»ºè§†é¢‘çš„ä¸€äº›å‚æ•°:param width: ç”Ÿæˆè§†é¢‘çš„å®½åº¦ default: 1920:param height: ç”Ÿæˆè§†é¢‘çš„é«˜åº¦ default: 1080:param images_origin: æºå›¾ç‰‡çš„è·¯å¾„:param origin_target_dir: å°†æºè·¯å¾„æ›¿æ¢ä¸ºç›®æ ‡è·¯å¾„ã€‚ è¿™ä¸ªé¡¹ç›®çš„æºè·¯å¾„æ˜¯çˆ¬è™«ä¸‹è½½å›¾ç‰‡çš„è·¯å¾„ï¼Œæœ€åè¿˜è¦æŠŠä¸‹è½½çš„å›¾ç‰‡å¤„ç†æˆå’Œè§†é¢‘ä¸€æ ·çš„å¤§å°å­˜æ”¾åœ¨ç›®æ ‡ç›®å½• default: (â€˜./src/imagesâ€™, â€˜./src/imgsâ€™):param music: èƒŒæ™¯éŸ³ä¹è·¯å¾„:param fps: è§†é¢‘çš„å¸§ç‡ default: 30:param output: ç”Ÿæˆè§†é¢‘çš„æ–‡ä»¶å å¦‚æ­¤ï¼Œæˆ‘ä»¬å…ˆæ¥å®šä¹‰è¦è·å–çš„å‚æ•°ã€‚è¿™é‡Œç”¨åˆ°äº†Clickï¼Œå®ƒä»¥ç®€å•çš„äº¤äº’æ–¹å¼ï¼Œå¸®åŠ©æˆ‘åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è·å–éœ€è¦çš„å‚æ•°å€¼ã€‚ # createVideoWithMoviepy.py @python31234567891011# -*- coding: utf-8 -*-import click@click.command()@click.option('--width', prompt='Width', default=1920, help='The width of video clips')@click.option('--height', prompt='Height', default=1080, help='The height of video clips')@click.option('--images_origin', prompt='images file', default='./src/images', help='The source images path')@click.option('--origin_target_dir', prompt='replace origin dir to target dir', default=('./src/images', './src/imgs'), help='how replace origin dir to target dir')@click.option('--music', prompt='Music file', default='./src/music/1302.mp3', help='The music file')@click.option('--fps', prompt='video fps ', default=30, help='The output video fps')@click.option('--output', prompt='Output file', default='./dist/1353112775.mp4', help='The output file name') è·å–ç›¸ç‰‡å¹¶è°ƒæ•´ç›¸ç‰‡å¤§å°# createVideoWithMoviepy.py @python3123456789101112131415161718192021222324252627282930# -*- coding: utf-8 -*-print('&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¼€å§‹åŠ è½½åº“&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;')import osimport mathimport click# å¯¼å…¥ä¸¤ä¸ªå·¥å…·å‡½æ•°æ¥å¤„ç†å›¾ç‰‡ï¼Œè¿™é‡Œä¸å±•å¼€è¯´æ˜ï¼Œå…·ä½“çœ‹æºç from utils import resizeImage, readDirdef main(width, height, images_origin, origin_target_dir, music, fps, output): # ä»æºç›®å½•è¯»å–ä¸”ç»å¤„ç†è¿‡çš„å›¾ç‰‡ï¼Œå°†ä¼šä¿å­˜åˆ°è¿™ä¸ªç›®å½•ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿å¤„ç†ï¼Œè¿™é‡Œå°½é‡å’Œæºç›®å½•çš„ç»“æ„ä¿æŒä¸€è‡´ target_images_dir = images_origin.replace(origin_target_dir[0], origin_target_dir[-1]) # å¦‚æœç›®æ ‡ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™ä»æºç›®å½•è¯»å–å›¾ç‰‡å¹¶è¿›è¡Œå¤„ç†ï¼Œæœ€åä¿å­˜åˆ°ç›®æ ‡ç›®å½• if not os.path.exists(target_images_dir): filesPath = readDir(images_origin) print('&gt;&gt;å·²è½½å…¥æ–‡ä»¶ %s ä¸ª' % len(filesPath)) print('&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¼€å§‹è°ƒæ•´å›¾ç‰‡å¤§å°&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;') for img in filesPath: resizeImage(img, origin_target_dir, (width, height)) # ä»ç›®æ ‡ç›®å½•ä¸­è¯»å–å›¾ç‰‡è·¯å¾„åˆ°ä¸€ä¸ªåˆ—è¡¨é‡Œ print('&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¼€å§‹è¯»å–è°ƒæ•´è¿‡çš„å›¾ç‰‡&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;') filesPath = readDir(images_origin.replace(origin_target_dir[0], origin_target_dir[-1])) print('&gt;&gt;å·²è½½å…¥æ–‡ä»¶ %s ä¸ª' % len(filesPath)) # å¦‚æœæ–‡ä»¶åˆ—è¡¨é•¿åº¦ä¸º 0ï¼Œåˆ™é€€å‡ºæ•´ä¸ªç¨‹åº if len(filesPath) == 0: print('&gt;&gt;è¯·æ£€æŸ¥æºç›®å½• %s ä¸‹æ˜¯å¦æœ‰å›¾ç‰‡ã€‚å¹¶ä¸”åˆ é™¤ %s ç›®å½•' % (images_origin, origin_target_dir[-1])) os._exit(0) ä½¿ç”¨ librosa åˆ†æ BGM çš„èŠ‚æ‹# createVideoWithMoviepy.py @python31234567import librosa print('&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¼€å§‹åˆ†æèŠ‚æ‹&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;') y, sr = librosa.load(music, sr=None) tempo, beats = librosa.beat.beat_track(y=y, sr=sr) beat_times = list(librosa.frames_to_time(beats, sr=sr)) beat_times.append(beat_times[-1] + 1) # å¢åŠ ä¸€ä¸ªç©ºèŠ‚æ‹ç‚¹ä½ï¼Œå…ˆè®°ç€æœ‰è¿™ä¹ˆä¸€å›äº‹ï¼Œä¸‹é¢ä¼šè®² åˆ›å»ºè§†é¢‘å‰ªè¾‘ï¼ˆClipï¼‰å‰çš„ä¸€äº›å°å‡†å¤‡å…ˆç®€å•è¯´ä¸€ä¸‹è§†é¢‘/åŠ¨ç”»çš„å°åŸç†ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ¯ä¸€ç§’ç”»é¢ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”±å¾ˆå¤šå¸§ç»„æˆçš„ã€‚åœ¨è¿™ä¸ªé¡¹ç›®é‡Œï¼Œä¸€ç§’ç”»é¢æœ‰ 30 å¸§ï¼ˆ30fpsï¼‰ã€‚è€Œä¸€ä¸ªåŠ¨ä½œçš„è¿ç»­ç”»é¢ï¼Œè‡³å°‘è¦æœ‰å¤´å°¾ä¸¤ä¸ªåŠ¨ä½œå…³é”®å¸§ã€‚ä½†æ˜¯ç°åœ¨åªæœ‰å•å¹…çš„ç›¸ç‰‡ï¼Œè¡¨ç°ä¸å‡ºä¸€ä¸ªå®Œæ•´çš„åŠ¨ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆçš„æˆå“ä¼šæ˜¯ä¸€ä¸ªå¹»ç¯ç‰‡ã€‚ğŸ˜… åˆ°è¿™é‡Œå°±å¤§æ¦‚æ¸…æ¥šäº†ï¼Œå¦‚æœè¦è®©ä¸€å¹…ç…§ç‰‡æ’­æ”¾ä¸€ç§’ï¼Œé‚£å°±éœ€è¦åœ¨è¿™ä¸€ç§’é‡Œæ’å…¥ 30 å¸§ã€‚å› ä¸ºæ˜¯å•å¹…ï¼Œæ‰€ä»¥è¿™ 30 å¸§å°±æ˜¯è¿™å¹…ç…§ç‰‡é‡å¤ 30 æ¬¡ã€‚ é¡¹ç›®è¦æ±‚æˆ‘ä»¬æŒ‰ç…§èŠ‚æ‹æ¥æ˜¾ç¤ºç›¸ç‰‡ï¼Œä½†æ˜¯ä¸¤ä¸ªèŠ‚æ‹ä¹‹é—´çš„é—´éš”å¯èƒ½ä¸åˆ°ä¸€ç§’ï¼Œæ‰€ä»¥ç›¸ç‰‡çš„å¸§æ•°å¯èƒ½æœ‰å¤šæœ‰å°‘ï¼Œä¸ä¸€å®šæ˜¯ 30 å¸§ã€‚ è€Œä¸”ä¸€ç§’çš„ç”»é¢åœç•™æ—¶é—´å¤ªçŸ­ï¼Œä¹Ÿå°±æ˜¯ä¸€é—ªè€Œè¿‡çš„æ•ˆæœï¼Œæ ¹æœ¬çœ‹ä¸æ¸…ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ #createVideoWithMoviepy.py @python31234567891011clips = [] # åˆ›å»ºä¸€ä¸ªç©ºçš„ listï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„å‰ªè¾‘audio_time = librosa.get_duration(filename=music)print('&gt;&gt;éŸ³é¢‘æ—¶é•¿(s):%f &gt;&gt;èŠ‚æ‹æ•°é‡ï¼š%s' % (audio_time, len(beat_times)))'''è®¡ç®—èŠ‚æ‹æ•°é‡å’Œç›¸ç‰‡æ•°é‡çš„å·®å€¼æ¯”ä¾‹ï¼Œä»¥è®¡ç®—éœ€è¦åœ¨æ¯å¹…ç›¸ç‰‡åè¡¥è¶³å¤šå°‘å¸§ï¼Œè¿™é‡Œè®¡ç®—çš„å·®å€¼ï¼Œæ˜¯ä¸ºäº†è®©ç›¸ç‰‡èƒ½è¡¥è¶³èŠ‚æ‹çš„æ•°é‡ï¼Œå¤šè·¨å‡ ä¸ªèŠ‚æ‹ï¼Œè®©æ¯ä¸€å¹…ç›¸ç‰‡åœç•™æ›´é•¿æ—¶é—´ã€‚å¦å¤–ï¼Œè¿™ä¸ªç®—æ³•æœ‰ bugï¼Œä¸‹é¢å†è¯´ã€‚'''interval = math.ceil(abs( len(beat_times) / len(filesPath) ))filesPath = [f for f in filesPath for i in range( interval )]print('&gt;&gt;æ–°çš„æ–‡ä»¶åˆ—è¡¨é•¿åº¦:%s' % len(filesPath)) æŒ‰èŠ‚æ‹æ’å…¥å¸§# createVideoWithMoviepy.py @python31234567891011121314151617181920212223print('&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¼€å§‹æŒ‰èŠ‚æ‹ç”Ÿæˆè§†é¢‘å¸§&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;')for index, beat_time in enumerate(beat_times[:-1]): if index &gt;= len( filesPath): print('&gt;&gt;å›¾ç‰‡æ•°é‡ä¸è¶³ä»¥åŒ¹é…èŠ‚æ‹ï¼Œä¸­æ­¢åŒ¹é…ã€‚è¾“å‡ºçš„è§†é¢‘åæ®µå¯èƒ½ä¼šå‡ºç°é»‘å±ã€‚') print('&gt;&gt;å›¾ç‰‡æ•°é‡ï¼š{0} &gt;èŠ‚æ‹æ•°é‡ï¼š{1}'.format(len( filesPath), len(beat_times))) break print(f'{index + 1}/{len(beat_times)}&gt;&gt;{ filesPath[index]}') ''' è¯´ä¸‹ time_deff çš„ä½œç”¨ï¼š å› ä¸ºæ¯ä¸ªèŠ‚æ‹é—´çš„é—´éš”æ—¶é—´éå¸¸çŸ­ï¼Œæ‰€ä»¥è®¡ç®—èŠ‚æ‹é—´çš„é—´éš”å†ä¹˜ä»¥å¸§ç‡ï¼Œ å¾—å‡ºè¿™å¹…ç”»é¢åœ¨è¿™ä¸ªèŠ‚æ‹åº”è¯¥åœç•™çš„æ—¶é—´ '''` time_diff = math.modf(beat_time - beat_times[index -1]) time_diff = math.ceil(time_diff[0]*10) if (time_diff[0] * 10) &gt; time_diff[-1] else math.ceil(time_diff[-1]) image_clip = (ImageClip(filesPath[index], duration=abs(time_diff)*fps) .set_fps(abs(time_diff)*fps) .set_start(beat_time) .set_end(beat_times[index + 1])) #è¿˜è®°å¾—ä¸Šé¢å¢åŠ çš„é‚£ä¸ªç©ºèŠ‚æ‹ç‚¹ä½ä¹ˆï¼Ÿéœ€è¦ç»™æœ€åä¸€å¸§ä¸€ä¸ªç»“æŸæ—¶é—´ï¼Œæ‰€ä»¥è¿™é‡Œå¢åŠ äº†ä¸€ä¸ªç©ºç‚¹ä½æ¥å¤„ç† image_clip = image_clip.set_pos('center') # ä¸¤å¹…ä¸åŒçš„ç›¸ç‰‡é—´çš„è¿‡æ¸¡æ–¹å¼ï¼Œduration çš„å€¼å¯ä»¥éšæ„æ›´æ”¹ï¼Œä¸è¿‡å¯èƒ½ä¼šå¢åŠ è§†é¢‘å‹åˆ¶çš„æ—¶é—´ if index % interval == 0: image_clip = image_clip.fx(vfx.fadein, duration=0.5) clips.append(image_clip) åˆå¹¶å‰ªè¾‘ï¼Œç”Ÿæˆè§†é¢‘ç»ˆäºåˆ°æœ€åä¸€æ­¥äº†ï¼ # createVideoWithMoviepy.py1234567891011121314print('&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;å¼€å§‹åˆå¹¶å‰ªè¾‘ï¼Œç”Ÿæˆè§†é¢‘&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;')final_clip = CompositeVideoClip(clips) # åˆå¹¶æ‰€æœ‰è§†é¢‘å‰ªè¾‘audio_clip = AudioFileClip(music) # åˆ›å»ºä¸€ä¸ªéŸ³é¢‘å‰ªè¾‘final_video = final_clip.set_audio(audio_clip) # åŠ å…¥éŸ³é¢‘å‰ªè¾‘# æœ€åå†™å…¥è§†é¢‘æ–‡ä»¶ï¼Œmoviepy ä¼šè°ƒç”¨ ffmpeg æ¥å‹åˆ¶æœ€åçš„è§†é¢‘ï¼Œæ²¡æœ‰è¿™ä¸ªåŒ…ï¼Œä¹Ÿå¾—è£…ä¸Šfinal_video.write_videofile( output, # è¾“å‡ºè·¯å¾„å’Œæ–‡ä»¶å fps=fps, # å¸§ç‡ codec='mpeg4', # è§†é¢‘ç¼–ç  # ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow, placebo preset='medium', # å‹ç¼©é€Ÿåº¦ audio_codec=\"libmp3lame\", # éŸ³é¢‘ç¼–ç ï¼Œé€‚ç”¨ .mp3 threads=4, # å‹ç¼©çº¿ç¨‹ bitrate ='6000k') # è§†é¢‘æ¯”ç‰¹ç‡ï¼Œ1080p 30fps çš„åŠ¨æ€æ¯”ç‰¹ç‡æ˜¯ 4000k~6000k ä¸€ä¸ªé—®é¢˜è¿˜è®°å¾—ä¸Šé¢æåˆ°çš„é‚£ä¸ª bug å—ï¼Ÿè¿™é‡Œé¢æœ‰ä¸€äº›é—®é¢˜ï¼Œå¦‚æœå›¾ç‰‡æ•°é‡å¤šäºèŠ‚æ‹æ•°ï¼Ÿå¦‚æœè¡¥é½èŠ‚æ‹æ•°é‡åçš„å›¾ç‰‡ list length å¤šäºèŠ‚æ‹æ•°ï¼Ÿå¦‚ä½•ç¡®å®šåŒ¹é… bgm èŠ‚æ‹çš„æœ€ä½³å›¾ç‰‡æ•°é‡å’Œå¸§ç‡ï¼Ÿ æ€»ç»“è¿™ä¸ªè„šæœ¬é—®é¢˜è¿˜æ˜¯æŒºå¤šçš„ï¼Œä½†æ˜¯å®Œæˆäº†æˆ‘æœ€åˆçš„è¦æ±‚ã€‚å”¯ä¸€ä¸æ»¡æ„çš„å°±æ˜¯è¿™æ˜¯ä¸€ä¸ªåŠ äº† BGM çš„å¹»ç¯ç‰‡ï¼Œæˆ‘ä¸‹æ¬¡è¿˜æ˜¯çˆ¬è§†é¢‘å§ã€‚ moviepy åšé€å¸§åŠ¨ç”»ä¸æ˜¯å¼ºé¡¹ï¼Œæ•ˆç‡ä½äº opencvï¼Œä½†æ˜¯å¦‚æœæƒ³è¦æ‰¹é‡ä¿®æ”¹ä¸€äº›æ¯”è¾ƒç›¸ä¼¼çš„è§†é¢‘å‰ªè¾‘ï¼Œè¿˜æ˜¯å¯ä»¥ç”¨çš„ã€‚è¿™è´§æœ‰ä¸€ä¸ªå¤§ç¼ºç‚¹ï¼Œå°±æ˜¯å¤ªè´¹å†…å­˜äº†ï¼Œæ–‡æ¡£ä¹Ÿä¸å¤Ÿå‹å¥½ã€‚ä½†æ˜¯ï¼Œå¥½ç”¨å°±å¤Ÿäº†ã€‚ librosa è¿™ä¸ªåº“ä¹Ÿå¾ˆå¼ºå¤§ï¼Œèƒ½å¤Ÿå„ç§åˆ†æéŸ³é¢‘ï¼Œå¯¹å£°éŸ³é¢†åŸŸæœ‰è¦æ±‚çš„å°ä¼™ä¼´å¯ä»¥è¯•è¯•ã€‚ å¤§å®¶å…³å¿ƒçš„æºç ï¼ŒCreate video with Moviepy","link":"/Technology/Python/create-video-with-moviepy/"},{"title":"MirageJS Quickstarts Part 1 - Overview","text":"æœ€è¿‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº† Mirage ,çœ‹ç€å®˜æ–¹æ–‡æ¡£ï¼Œåšäº†ä¸€äº›ç¬”è®°ã€‚æ–‡ä¸­çš„å†…å®¹éƒ½æ¥è‡ªäºå®˜æ–¹æ–‡æ¡£ï¼ŒåŒ…æ‹¬ä¾‹å­ï¼Œå¹¶ä¸æ˜¯å®Œæ•´ç¿»è¯‘äº†å®˜æ–¹æ–‡æ¡£ï¼Œç»“åˆè‡ªå·±çš„ä½¿ç”¨ä½“ä¼šåšäº†å¢åˆ ï¼Œå°±æ˜¯ç¿»è¯‘äº†åˆæ²¡å®Œå…¨ç¿»è¯‘ã€‚ ç®€ä»‹Mirage æ˜¯ä¸€ä¸ªè®©å‰ç«¯å¼€å‘äººå‘˜æ¨¡æ‹Ÿåç«¯ API çš„ JavaScript åº“ã€‚ç”¨äººè¯è¯´å°±æ˜¯ï¼šMirage æ˜¯ä¸€ä¸ª Mock æœåŠ¡å™¨ã€‚ Mirage åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚å®ƒèƒ½æ‹¦æˆª Javascript åº”ç”¨ç¨‹åºå‘å‡ºçš„ä»»ä½• XMLHttpRequest æˆ– fetch è¯·æ±‚ï¼Œå¹¶å…è®¸æ¨¡æ‹Ÿè¿™äº›è¯·æ±‚æ‰€å¯¹åº”çš„å“åº”ç»“æœã€‚ Mirage é™¤äº†æ‹¦æˆª HTTP è¯·æ±‚å¤–ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿæ•°æ®åº“å’Œä¸€ç³»åˆ—è¾…åŠ©å‡½æ•°ï¼Œå¯ä»¥è½»æ¾æ¨¡æ‹Ÿåç«¯æœåŠ¡ã€‚ Mirage å€Ÿé‰´äº†å…¸å‹çš„ API æœåŠ¡ç«¯æ¡†æ¶çš„æ¦‚å¿µï¼Œæ‹¥æœ‰ä¾‹å¦‚ï¼š å¤„ç† HTTP è¯·æ±‚çš„è·¯ç”±ï¼ˆroutesï¼‰ æ•°æ®åº“ï¼ˆdatabaseï¼‰å’Œæ•°æ®æ¨¡å‹ï¼ˆmodelsï¼‰ï¼Œç”¨äºå­˜å‚¨æ•°æ®å’Œå®šä¹‰æ•°æ®ä¹‹é—´çš„å…³ç³» factories(æ¨¡å‹å·¥å‚) and fixtures for stubbing data(æ•°æ®å¡«å……) ç”¨äºæ ¼å¼åŒ– HTTP å“åº”çš„åºåˆ—åŒ–å‡½æ•°ï¼ˆserializersï¼‰ å®‰è£…Mirage å¾ˆå®¹æ˜“å¯ä»¥é›†æˆåˆ°ç°æœ‰é¡¹ç›®ä¸­ã€‚ 123npm install --save-dev miragejs# oryarn add --dev miragejs æ¦‚è§ˆMirage å¯ä»¥é€šè¿‡ è·¯ç”±å¤„ç†å™¨ï¼ˆroute handlersï¼‰è½»æ˜“çš„æ¨¡æ‹Ÿä¸€ä¸ª API è¯·æ±‚çš„å“åº”ç»“æœã€‚ é™æ€è·¯ç”±ï¼ˆStatic Route Handlersï¼‰123456789101112131415161718import { createServer } from \"miragejs\"createServer({ routes() { this.namespace = 'api' // in app makes a GET request to `/api/movies`, Mirage will respond with this data. this.get('/movies', () =&gt; { return { movies: [ { id: 1, name: 'Inception', year: 2010}, { id: 1, name: 'Interstellar', year: 2014}, { id: 1, name: 'Dunkirk', year: 2017}, ], } }) }}) å¯ä»¥åƒä¸Šé¢è¿™ä¸ªç¤ºä¾‹ä¸­ä¸€æ ·ï¼Œä½¿ç”¨é™æ€è·¯ç”±æ¥å®Œæˆå¯¹ API è¿”å›çš„æ¨¡æ‹Ÿã€‚è·¯ç”±å¤„ç†å™¨æ”¯æŒæ‰€æœ‰çš„ HTTP åŠ¨è¯ï¼ˆget/post/delete/put â€¦ï¼‰ã€‚ ä¹Ÿå¯ä»¥åœ¨è·¯ç”±çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­ä½¿ç”¨ timing é€‰é¡¹æ¥æ¨¡æ‹ŸæœåŠ¡å™¨å»¶è¿Ÿã€‚ 123456789101112...// Using the `timing` option to slow down the responsethis.get( '/movies', () =&gt; { return { movies: [], } }, { timing: 4000 })... ä¹Ÿå¯ä»¥åœ¨è·¯ç”±ä¸­å®šä¹‰å¦‚ä½•ä» API ä¸­è·å–éœ€è¦çš„è¯·æ±‚å‚æ•°ã€‚ 123456789...// Responding to a POST requestthis.post(\"/movies\", (schema, request) =&gt; { let attrs = JSON.parse(request.requestBody) attrs.id = Math.floor(Math.random() * 100) return { movie: attrs }})... ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª HTTP Errorã€‚ 123456789...// Using the `Response` class to return a 500this.delete(\"/movies/1\", () =&gt; { let headers = {} let data = { errors: [\"Server did not respond\"] } return new Response(500, headers, data)})... åŠ¨æ€è·¯ç”±ï¼ˆDynamic Route Handlersï¼‰é™æ€è·¯ç”±å·²ç»å¯ä»¥å¾ˆå¥½çš„å·¥ä½œäº†ã€‚ä½†æ˜¯é™æ€è·¯ç”±ä¸èƒ½æ€»æ˜¯æ»¡è¶³æˆ‘ä»¬èŠ±æ ·è¯·æ±‚æ•°æ®çš„éœ€æ±‚ï¼Œæ¯”å¦‚æŒ‰æ¡ä»¶ç­›é€‰æŸ¥è¯¢ç»“æœæ—¶ï¼Œé™æ€è·¯ç”±å°±ä¸èƒ½å¾ˆå¥½çš„æ»¡è¶³éœ€æ±‚ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½æ¨¡æ‹ŸçœŸå®æŸ¥è¯¢æ•°æ®åº“æ—¶é‚£ç§æ–¹å¼ï¼Œè®©æˆ‘ä»¬åœ¨è·¯ç”±ä¹‹å‰å…ˆå¼•å…¥æ•°æ®æ¨¡å‹ã€‚ 123456789101112131415import { createServer, Model } from \"miragejs\"createServer({ // å¼•å…¥å¹¶å®šä¹‰æ•°æ®æ¨¡å‹ models: { movie: Model, }, routes() { this.namespace = 'api' // schema å‚æ•°å¯ä»¥è®¿é—®åˆ° model ä¸­çš„æ•°æ® this.get('/movies', (schema, request) =&gt; { return schema.movies.all() }) }}) å¦‚æœç°åœ¨è¯·æ±‚ GET /api/movies ï¼Œå°†è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡ç»™å®šä¹‰å¥½çš„æ¨¡å‹å¡«å……æ•°æ®ã€‚ 1234// GET /api/movies{ \"movies\": []} ç°åœ¨è®©æˆ‘ä»¬æ¥ç»™æ¨¡å‹å¡«å……æ•°æ®ã€‚ 123456789createServer({ models: {}, routes() {}, seeds(server) { server.create(\"movie\", { name: \"Inception\", year: 2010 }) server.create(\"movie\", { name: \"Interstellar\", year: 2014 }) server.create(\"movie\", { name: \"Dunkirk\", year: 2017 }) },}) server.create() æ–¹æ³•å°†å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼ˆMirage ä¼šåœ¨å†…å­˜ä¸­è¿è¡Œä¸€ä¸ªæ•°æ®åº“ï¼‰ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å‹çš„åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æ’å…¥çš„æ•°æ®ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯ä»¥æ¨¡å‹å·¥å‚é‡Œï¼Œé…åˆ Marak/faker.js ç­‰åº“æ’å…¥å¤§é‡çš„å‡æ•°æ®ç”¨äºæµ‹è¯•ã€‚ ç°åœ¨å†è¯·æ±‚ GET /api/movies ,å°†ä¼šè¿”å›ä¸€ä¸ªç»“æœï¼š 123456789// GET /api/movies{ \"movies\": [ { \"id\": 1, \"name\": \"Inception\", \"year\": 2010 }, { \"id\": 2, \"name\": \"Interstellar\", \"year\": 2014 }, { \"id\": 3, \"name\": \"Dunkirk\", \"year\": 2017 } ]} æ—¢ç„¶æ˜¯åŠ¨æ€è·¯ç”±ï¼Œé‚£åº”è¯¥åšä¸€äº›åŠ¨æ€è·¯ç”±åº”è¯¥ä½œçš„äº‹æƒ…ã€‚ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨æ ‡å‡†çš„ RESTful è·¯ç”±æ¨¡å¼æ¥è¿”å› Movie èµ„æºï¼š 1234567891011121314151617181920212223242526272829this.get(\"/movies\", (schema, request) =&gt; { return schema.movies.all()})this.get(\"/movies/:id\", (schema, request) =&gt; { let id = request.params.id return schema.movies.find(id)})this.post(\"/movies\", (schema, request) =&gt; { let attrs = JSON.parse(request.requestBody) return schema.movies.create(attrs)})this.patch(\"/movies/:id\", (schema, request) =&gt; { let newAttrs = JSON.parse(request.requestBody) let id = request.params.id let movie = schema.movies.find(id) return movie.update(newAttrs)})this.delete(\"/movies/:id\", (schema, request) =&gt; { let id = request.params.id return schema.movies.find(id).destroy()}) è·¯ç”±ç¼©å†™ï¼ˆShorthandsï¼‰ä½¿ç”¨ç¼©å†™å¯ä»¥å‡å°‘ä»£ç çš„å†—ä½™ï¼Œä¹Ÿå¯ä»¥è®©è·¯ç”±å®šä¹‰æ›´ç®€æ´ã€‚åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€è·¯ç”±ä¸€èŠ‚é‡Œï¼Œ RESTful è¯·æ±‚è¿”å›çš„ç¤ºä¾‹ä¸­çš„æ‰€æœ‰è·¯ç”±å®šä¹‰ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç¼©å†™çš„æ–¹å¼æ¥å®Œæˆï¼Œè·¯ç”±ç¼©å†™ä¸ä¸Šé¢ä¾‹å­ä¸­å®šä¹‰çš„åŒåè·¯ç”±å®Œæˆä¸€æ ·çš„å·¥ä½œï¼š 12345this.get(\"/movies\")this.get(\"/movies/:id\")this.post(\"/movies\")this.patch(\"/movies/:id\")this.del(\"/movies/:id\") éå¸¸å»ºè®®å§‹ç»ˆä½¿ç”¨è·¯ç”±ç¼©å†™æ¥å®šä¹‰è·¯ç”±ï¼Œé™¤éä½ éœ€è¦åœ¨è·¯ç”±å®šä¹‰é‡Œå®Œæˆé¢å¤–çš„å·¥ä½œã€‚ æ¨¡å‹å·¥å‚ï¼ˆFactoriesï¼‰æ¨¡å‹å·¥å‚æ˜¯ä¸€ä¸ªå¯ä»¥ä¸ºæŒ‡å®šæ¨¡å‹ç”Ÿæˆé€¼çœŸç§å­æ•°æ®çš„å¯¹è±¡ï¼Œæœ€ç»ˆå°†ç”¨ç”Ÿæˆçš„ç§å­æ•°æ®å¡«å……åˆ°æ¨¡å‹ä¸­ã€‚ 123456789101112131415161718192021222324import { createServer, Model, Factory } from \"miragejs\"createServer({ models: { movie: Model, }, factories: { movie: Factory.extend({ title(i) { return `Movie ${i}` // Movie 1, Movie 2, etc. }, year() { let min = 1950 let max = 2019 return Math.floor(Math.random() * (max - min + 1)) + min }, rating: \"PG-13\", }), },}) ç°åœ¨ä½¿ç”¨ server.create APIæ¥ä¸º movie æ¨¡å‹åˆ›å»ºæ•°æ®ï¼ŒMirage å°†ä¼šä½¿ç”¨å®šä¹‰å¥½çš„æ¨¡å‹å·¥å‚æ¥ç”Ÿæˆé»˜è®¤çš„æ•°æ®ã€‚ 123456789101112131415161718192021222324252627282930313233server.create(\"movie\")server.create(\"movie\")// å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„æ•°æ®æ›¿æ¢ç”Ÿæˆçš„æ•°æ®ä¸­æŒ‡å®šçš„å±æ€§çš„å€¼server.create(\"movie\", { rating: \"R\" })server.db.dump()/* Mirage's database now contains { movies: [ { id: 1, title: \"Movie 1\", year: 1992, rating: \"PG-13\", }, { id: 2, title: \"Movie 2\", year: 2008, rating: \"PG-13\", }, { id: 3, title: \"Movie 3\", year: 1947, rating: \"R\", } ] }*/ ä½¿ç”¨ server.createList API æ¥æ‰¹é‡ç”Ÿæˆæ•°æ®ï¼Œå¯ä»¥åœ¨ seeds() æ–¹æ³•ä¸­åŒæ—¶ä½¿ç”¨ server.create å’Œ server.createList APIã€‚ 1234567import { createServer, Factory } from \"miragejs\"createServer({ seeds(server) { server.createList(\"movie\", 10) },}) åœ¨ç¼–å†™å•å…ƒæµ‹è¯•æ—¶ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰ï¼ŒMirage ä¼šè½½å…¥è·¯ç”±å®šä¹‰ï¼Œä½†ä¼šå¿½ç•¥ä¸ºè·¯ç”±ç”Ÿæˆçš„ç§å­æ•°æ®ï¼Œä½†æ˜¯å‹¿éœ€æ‹…å¿ƒï¼Œä½ å¯ä»¥åœ¨å¼€å§‹æµ‹è¯•ä¹‹å‰ä¸º Mirage è·¯ç”±ç”Ÿæˆæ•°æ®ã€‚ 1234567891011121314151617181920212223242526// app-test.jsimport React from \"react\"import { render, waitForElement } from \"@testing-library/react\"import App from \"./App\"import startMirage from \"./start-mirage\"let serverbeforeEach(() =&gt; { server = startMirage({ environment: \"test\" })})afterEach(() =&gt; { server.shutdown()})it(\"shows the list of movies\", async () =&gt; { // ç”Ÿæˆæµ‹è¯•æ•°æ® server.createList(\"movie\", 5) const { getByTestId } = render(&lt;App /&gt;) await waitForElement(() =&gt; getByTestId(\"movie-list\")) expect(getByTestId(\"movie-item\")).toHaveLength(5)}) æ•°æ®å…³ç³»ï¼ˆRelationshipsï¼‰Mirage æä¾›äº† ORM æ¥å¤„ç†æ•°æ®å…³ç³»ã€‚ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œä¸€éƒ¨å½±ç‰‡å¯ä»¥æœ‰å¤šä¸ªæ¼”å‘˜ï¼Œæ‰€ä»¥æ¥å®šä¹‰ä¸€ä¸ªä¸€å¯¹å¤šçš„å…³ç³»ï¼š 123456789101112131415161718192021222324import { createServer, hasMany, belongsTo } from \"miragejs\"createServer({ models: { movie: Model.extend({ castMembers: hasMany(), }), castMember: Model.extend({ movie: belongsTo(), }), }, seeds(server) { server.create('movie', { name: \"Interstellar\", year: 2014, castMembers: [ server.create(\"cast-member\", { name: \"Matthew McConaughey\" }), server.create(\"cast-member\", { name: \"Anne Hathaway\" }), server.create(\"cast-member\", { name: \"Jessica Chastain\" }), ], }) },}) æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ¨¡å‹ movie å’Œ castMember ï¼Œå¹¶ä¸”å®šä¹‰äº†ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´çš„å…³ç³»ã€‚ç°åœ¨å°±å¯ä»¥åœ¨è·¯ç”±å®šä¹‰ä¸­æŸ¥è¯¢å‡ºå…³è”çš„æ•°æ®äº†ï¼š 12345this.get('/movie/:id/cast-menbers', (schema, request) =&gt; { let movie = schema.movies.find(request.params.id) return movie.castMembers}) Mirage ä¼šè‡ªåŠ¨ä½¿ç”¨å¤–é”®æ¥ç»´æŠ¤ä¸¤ä¸ªæ¨¡å‹é—´çš„å…³ç³»ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒæ•°æ®ä¼šæ··ä¹±ã€‚ å“åº”æ•°æ®åºåˆ—åŒ–ï¼ˆSerializersï¼‰Mirage é»˜è®¤è¿”å›çš„å“åº”æ•°æ®æ˜¯è¿™æ ·å­çš„ï¼š 123456789// GET /api/movies{ \"movies\": [ { \"id\": 1, \"name\": \"Inception\", \"year\": 2010 }, { \"id\": 2, \"name\": \"Interstellar\", \"year\": 2014 }, { \"id\": 3, \"name\": \"Dunkirk\", \"year\": 2017 } ]} ä¹Ÿè®¸ä½ çš„äº§å“ä½¿ç”¨çš„æ˜¯ JSON:API spec ï¼Œæ‰€ä»¥å“åº”çš„æ•°æ®çœ‹èµ·æ¥åƒè¿™æ ·å­ï¼š 123456789101112131415161718192021// GET /api/movies{ \"data\": [ { \"id\": 1, \"type\": \"movies\", \"attributes\": { \"name\": \"Inception\", \"year\": 2010 } }, { \"id\": 2, \"type\": \"movies\", \"attributes\": { \"name\": \"Interstellar\", \"year\": 2014 } }, { \"id\": 3, \"type\": \"movies\", \"attributes\": { \"name\": \"Dunkirk\", \"year\": 2017 } } ]} Mirage çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†å®Œæ•´é‡ç°ä½ çš„äº§å“çš„ API æœåŠ¡ã€‚å€ŸåŠ© Mirage æä¾›çš„æ•°æ®åºåˆ—åŒ–ï¼ˆSerializersï¼‰èƒ½åŠ›ï¼Œå¯ä»¥è‡ªå®šä¹‰æ ¼å¼åŒ–å“åº”æ•°æ®ã€‚ Mirage æä¾›äº†å‡ ä¸ªä¸æµè¡Œçš„åç«¯æ•°æ®å“åº”æ ¼å¼åŒ¹é…çš„å‘½ååºåˆ—åŒ–æ–¹æ³•ï¼š 1234567import { createServer, JSONAPISerializer } from \"miragejs\"createServer({ serializers: { application: JSONAPISerializer, }}) ä¾‹å­ä¸­åªæ¼”ç¤ºäº† JSONAPISerializer ï¼Œå®é™…è¿˜æœ‰ ActiveModelSerializer å’Œ RestSerializer ï¼Œå°†åœ¨åé¢çš„ç« èŠ‚ä½œè¯¦ç»†çš„è¯´æ˜ã€‚ å¦‚æœ Mirage æä¾›çš„åºåˆ—åŒ–ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå¯ä»¥åŸºäº Serializer åŸºç±»æ‰©å±•è‡ªå·±çš„æ•°æ®æ ¼å¼ï¼š 1234567891011121314import { createServer, Serializer } from \"miragejs\"createServer({ serializers: { application: Serializer.extend({ keyForAttribute(attr) { return dasherize(attr) }, keyForRelationship(attr) { return dasherize(attr) }, }), },}) Mirage çš„åºåˆ—åŒ–å±‚çŸ¥é“æ¨¡å‹é—´çš„å…³ç³»ï¼Œè¿™æœ‰åˆ©äºæ¨¡æ‹Ÿæ•°æ®ä¾§è½½æˆ–è€…åµŒå¥—å…³ç³»æ•°æ®ï¼š 1234567891011createServer({ serializers: { movie: Serializer.extend({ include: [\"crewMembers\"], }), }, routes() { this.get(\"/movies/:id\") },}) å“åº”æ•°æ®ä¸­å°†è‡ªåŠ¨åŒ…å«å…³ç³»æ•°æ® crew-membersï¼š 12345678910111213141516171819202122232425// GET /movies/1{ \"movie\": { \"id\": 1, \"title\": \"Interstellar\" }, \"crew-members\": [ { \"id\": 1, \"movie-id\": 1, \"name\": \"Matthew McConaughey\" }, { \"id\": 2, \"movie-id\": 1, \"name\": \"Anne Hathaway\" }, { \"id\": 3, \"movie-id\": 1, \"name\": \"Jessica Chastain\" } ]} Mirage æä¾›çš„å‘½ååºåˆ—åŒ–æ–¹æ³•å®Œæˆäº†å¤§é‡è¯¸å¦‚æ­¤ç±»çš„å®šä¹‰å·¥ä½œï¼Œå› æ­¤åº”è¯¥å°†å®ƒä»¬ç”¨ä½œæœ€ç»ˆçš„æ•°æ®åºåˆ—åŒ–æ–¹æ³•ï¼Œå¹¶ä¸”ä»…åœ¨ä¸èƒ½æ»¡è¶³éœ€æ±‚æ—¶æ‰æ·»åŠ ç‰¹å®šçš„ API è‡ªå®šä¹‰é¡¹ã€‚ æ”¾è¡Œï¼ˆPassthroughï¼‰é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½ çš„åº”ç”¨å‘å‡ºçš„è¯·æ±‚æœªå®šä¹‰ç›¸åº”çš„ Mock è·¯ç”±è¯·æ±‚ï¼ŒMirage å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ å‡å¦‚ä½ ç°åœ¨çš„åº”ç”¨æ­£åœ¨ä½¿ç”¨ Mirage æˆ–è€…ä¸æƒ³ä½¿ç”¨ Mirage æ¨¡æ‹Ÿæ‰€æœ‰çš„ APIï¼Œä¸ºé¿å…å› æœªå®šä¹‰çš„è·¯ç”±è€ŒæŠ›å‡ºé”™è¯¯ï¼Œä½¿ç”¨ passthrough() æ–¹æ³•æ”¾è¡Œæœªå®šä¹‰çš„è¯·æ±‚ï¼š 123456createServer({ routes() { // Allow unhandled requests on the current domain to pass through this.passthrough() },}) å½“éœ€è¦ä¸ºç°æœ‰çš„åº”ç”¨å¼€å‘æ–°çš„åŠŸèƒ½ï¼Œä¸éœ€è¦ç­‰å¾…åç«¯çš„ API æ›´æ–°ï¼Œä½¿ç”¨ Mirage å°±å¯ä»¥æ¨¡æ‹Ÿæ–°çš„ API å¹¶ä¸”æ”¾è¡Œå·²ç»åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨çš„ API ï¼š 1234567891011121314createServer({ routes() { // Mock this route and Mirage will intercept it this.get(\"/movies\") // All other API requests on the current domain will still pass through // e.g. GET /api/directors this.passthrough() // If your API requests go to an external domain, pass those through by // specifying the fully qualified domain name this.passthrough(\"http://api.acme.com/**\") },}) é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥ä¸“æ³¨çš„å¼€å‘å’Œæµ‹è¯•æ–°åŠŸèƒ½è€Œä¸ç”¨æ‹…å¿ƒå› ä¸ºæ—§æ¥å£çš„å­˜åœ¨è€Œä¸èƒ½ Mockã€‚ æœ¬ç« èŠ‚çš„å†…å®¹å·²ç»è¶³å¤Ÿåœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨ Mirage äº†ã€‚ä¸‹ä¸€ç« èŠ‚æ¥è¯¦ç»†è¯´è¯´ Mirage ä¸­çš„ä¸€äº›ä¸»è¦æ¦‚å¿µã€‚","link":"/Notes/Mirage-JS/miragejs-quickstarts-part-1-overview/"}],"tags":[{"name":"WSL","slug":"WSL","link":"/tags/WSL/"},{"name":"environment","slug":"environment","link":"/tags/environment/"},{"name":"javascript","slug":"javascript","link":"/tags/javascript/"},{"name":"vue","slug":"vue","link":"/tags/vue/"},{"name":"vue-element-admin","slug":"vue-element-admin","link":"/tags/vue-element-admin/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"python3","slug":"python3","link":"/tags/python3/"},{"name":"moviepy","slug":"moviepy","link":"/tags/moviepy/"},{"name":"librosa","slug":"librosa","link":"/tags/librosa/"},{"name":"video","slug":"video","link":"/tags/video/"},{"name":"mock","slug":"mock","link":"/tags/mock/"},{"name":"API Mock","slug":"API-Mock","link":"/tags/API-Mock/"},{"name":"MirageJS","slug":"MirageJS","link":"/tags/MirageJS/"},{"name":"mirage","slug":"mirage","link":"/tags/mirage/"}],"categories":[{"name":"Notes","slug":"Notes","link":"/categories/Notes/"},{"name":"Technology","slug":"Technology","link":"/categories/Technology/"},{"name":"Python","slug":"Technology/Python","link":"/categories/Technology/Python/"},{"name":"Javascript","slug":"Technology/Javascript","link":"/categories/Technology/Javascript/"},{"name":"Mirage-JS","slug":"Notes/Mirage-JS","link":"/categories/Notes/Mirage-JS/"}]}